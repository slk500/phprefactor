<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-06-26 Wed 14:02 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PHPRefactor</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="slk500" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="export/styles/darksun/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="export/styles/darksun/css/darksun.css"/>
<link rel="stylesheet" type="text/css" href="export/styles/darksun/css/hideshow.css"/>
<script type="text/javascript" src="export/styles/darksun/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="export/styles/darksun/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="export/styles/darksun/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="export/styles/darksun/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="export/styles/darksun/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="export/styles/darksun/js/darksun.js"></script>
<script type="text/javascript" src="export/styles/darksun/js/hideshow.js"></script>
<script type="text/javascript" src="export/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">PHPRefactor</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org917b849">1. Books</a>
<ul>
<li><a href="#orgd44073d">1.1. Wake, William C.; Refactoring Workbook; 2003</a>
<ul>
<li><a href="#orga2da40c">1.1.1. https://xp123.com/articles/refactoring-workbook/</a></li>
</ul>
</li>
<li><a href="#org973d694">1.2. Working effectivly with legacy code</a></li>
<li><a href="#orgb65e7a0">1.3. Fowler, Martin; 2018</a></li>
<li><a href="#org5dd845a">1.4. Feathers, Michael; Working Effectively with Legacy Code; 2005</a></li>
<li><a href="#org15fbb27">1.5. Others</a></li>
</ul>
</li>
<li><a href="#orgf96e04b">2. Tutorials</a></li>
<li><a href="#orgdcf1171">3. Refactorings</a>
<ul>
<li><a href="#orga42279e">3.1. Add PHPDoc</a>
<ul>
<li><a href="#org23e28ca">3.1.1. Refactor the code</a></li>
</ul>
</li>
<li><a href="#orgc8cab55">3.2. Add Type-Hint</a>
<ul>
<li><a href="#org752f04c">3.2.1. Refactor the code</a></li>
<li><a href="#org8d2998f">3.2.2. Helper</a></li>
<li><a href="#org3f0d142">3.2.3. Further Reading</a></li>
</ul>
</li>
<li><a href="#org07370f4">3.3. Consolidate Conditional Expression</a>
<ul>
<li><a href="#org3bb09eb">3.3.1. Write a test that pass</a></li>
<li><a href="#org310dd22">3.3.2. Refactor the code</a></li>
<li><a href="#orgb9763b5">3.3.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org554906d">3.4. Consolidate Duplicate Conditional Fragments</a>
<ul>
<li><a href="#org261670f">3.4.1. Write a test that pass</a></li>
<li><a href="#org3241b05">3.4.2. Refactor the code</a></li>
<li><a href="#orgde9b6fb">3.4.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org72e7c4a">3.5. Decompose Conditional</a>
<ul>
<li><a href="#org974a9e3">3.5.1. Write a test that pass</a></li>
<li><a href="#orge6fb2a0">3.5.2. Refactor the code</a></li>
<li><a href="#org202bb28">3.5.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orge07391a">3.6. Encapsulate Field</a>
<ul>
<li><a href="#org58fc43e">3.6.1. Write a test that pass</a></li>
<li><a href="#orgc164ebb">3.6.2. Refactor the code</a></li>
<li><a href="#org7cd1fd7">3.6.3. Run a test</a></li>
</ul>
</li>
<li><a href="#orga55c5ea">3.7. Extract Class</a>
<ul>
<li><a href="#org6ac1e66">3.7.1. Write a test that pass</a></li>
<li><a href="#org6faa696">3.7.2. Refactor the code</a></li>
<li><a href="#orgf188dcc">3.7.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orgc25ed1a">3.8. Extract Function</a>
<ul>
<li><a href="#orgbb2097d">3.8.1. Write a test that pass</a></li>
<li><a href="#org62cbcc8">3.8.2. Refactor the code</a></li>
<li><a href="#orgb133eb2">3.8.3. Run a test</a></li>
<li><a href="#orgd02d792">3.8.4. Notes</a></li>
</ul>
</li>
<li><a href="#orgd6d5652">3.9. Extract Variable</a>
<ul>
<li><a href="#orgc090cc8">3.9.1. Write a test that pass</a></li>
<li><a href="#org4ffcd2e">3.9.2. Refactor the code</a></li>
<li><a href="#org89a9ddc">3.9.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org62c7347">3.10. Inline Class</a></li>
<li><a href="#org0184481">3.11. <span class="done DONE">DONE</span> Inline Function</a>
<ul>
<li><a href="#org8f0721b">3.11.1. Write a test that pass</a></li>
<li><a href="#orgf0805d9">3.11.2. Refactor the code</a></li>
<li><a href="#org5c1a1a2">3.11.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orgd32bbe4">3.12. Inline Variable</a>
<ul>
<li><a href="#org47e57ec">3.12.1. Refactor the code</a></li>
</ul>
</li>
<li><a href="#org3b95258">3.13. Introduce Parameter Object</a>
<ul>
<li><a href="#org7fe665e">3.13.1. Write a test that pass</a></li>
<li><a href="#org4bfa1f6">3.13.2. Refactor the code</a></li>
<li><a href="#orge0ba1a5">3.13.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orgabccbb2">3.14. Optimize Imports</a>
<ul>
<li><a href="#org9bc076b">3.14.1. Write a test that pass</a></li>
<li><a href="#orgf8cf30d">3.14.2. Refactor the code</a></li>
<li><a href="#org4f00cb4">3.14.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org7138895">3.15. Move Method</a>
<ul>
<li><a href="#org0f177cc">3.15.1. Write a test that pass</a></li>
<li><a href="#orgbac70ea">3.15.2. Refactor the code</a></li>
<li><a href="#org02c265f">3.15.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org71d1bb3">3.16. Parameterize Method</a>
<ul>
<li><a href="#org6c86875">3.16.1. <span class="todo TODO">TODO</span> Write a test that pass</a></li>
<li><a href="#org9e9dd73">3.16.2. Refactor the code</a></li>
<li><a href="#org3e1f870">3.16.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org9a58e89">3.17. Preserve Whole Object</a>
<ul>
<li><a href="#orgc913443">3.17.1. Write a test that pass</a></li>
<li><a href="#orga6344a2">3.17.2. Refactor the code</a></li>
<li><a href="#org7dc2ea5">3.17.3. Pass a test</a></li>
<li><a href="#org8bc345f">3.17.4. Refactor the code</a></li>
<li><a href="#orgfab140c">3.17.5. Pass a test</a></li>
<li><a href="#orgc8d13e1">3.17.6. Refactor the code</a></li>
<li><a href="#orgdbd886b">3.17.7. Pass a test</a></li>
</ul>
</li>
<li><a href="#org98e821e">3.18. Pull Up Method</a>
<ul>
<li><a href="#org3005bc2">3.18.1. Write a test that pass</a></li>
<li><a href="#orgb643baa">3.18.2. Refactor the code</a></li>
<li><a href="#org35e963f">3.18.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orgab5aca0">3.19. Remove Assignments to Parameters</a>
<ul>
<li><a href="#org4a099d6">3.19.1. Write a test that pass</a></li>
<li><a href="#orgb52ea44">3.19.2. Refactor the code</a></li>
<li><a href="#orgd947f02">3.19.3. Pass a test</a></li>
<li><a href="#orgfae7c9d">3.19.4. Info</a></li>
</ul>
</li>
<li><a href="#org8203ddf">3.20. Remove PHPDoc</a>
<ul>
<li><a href="#org0f91c48">3.20.1. Write a test that pass</a></li>
<li><a href="#org6b933c9">3.20.2. Refactor the code</a></li>
<li><a href="#org01b6afb">3.20.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org0e033da">3.21. Rename Function</a>
<ul>
<li><a href="#org989b44b">3.21.1. Write a test that pass</a></li>
<li><a href="#org7ab693d">3.21.2. Refactor the code</a></li>
<li><a href="#org79fe6a9">3.21.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org004ff4e">3.22. Replace Global with Dependency Injection</a>
<ul>
<li><a href="#orgd86567f">3.22.1. Write a test that pass</a></li>
<li><a href="#org808df43">3.22.2. Refactor the code</a></li>
<li><a href="#orgb918996">3.22.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org39b67cd">3.23. <span class="done DONE">DONE</span> Replace Magic Number With Symbolic Constant</a>
<ul>
<li><a href="#org5213d34">3.23.1. Write a test that pass</a></li>
<li><a href="#org09a3d34">3.23.2. Refactor the code</a></li>
<li><a href="#orgb05f65e">3.23.3. Run a test</a></li>
<li><a href="#org4b7890f">3.23.4. Helper:</a></li>
</ul>
</li>
<li><a href="#orgea73e4f">3.24. Replace Parameter with Method</a>
<ul>
<li><a href="#org6ce8ba4">3.24.1. Write a test that pass</a></li>
<li><a href="#org8039432">3.24.2. Refactor the code</a></li>
<li><a href="#org099ef05">3.24.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orgf3600f4">3.25. Replace Temp with Query</a>
<ul>
<li><a href="#org1dca37b">3.25.1. Write a test that pass</a></li>
<li><a href="#org8ebf533">3.25.2. Refactor the code</a></li>
<li><a href="#orgcba72e0">3.25.3. Pass a test</a></li>
<li><a href="#org1db8a64">3.25.4. Info</a></li>
</ul>
</li>
<li><a href="#orge41672f">3.26. Replacing Type Code with Subclasses</a>
<ul>
<li><a href="#orga11dad3">3.26.1. Write a test that pass</a></li>
<li><a href="#orgaaf88a0">3.26.2. Refactor the code</a></li>
<li><a href="#org01455bc">3.26.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#org271382f">3.27. Separate Query from Modifier</a>
<ul>
<li><a href="#orgae5c320">3.27.1. Write a test that pass</a></li>
<li><a href="#org30876f1">3.27.2. Refactor the code</a></li>
<li><a href="#org035405b">3.27.3. Pass a test</a></li>
</ul>
</li>
<li><a href="#orgc9939b6">3.28. Split Temporary Variable</a>
<ul>
<li><a href="#orgce8002f">3.28.1. Write a test that pass</a></li>
<li><a href="#org972d0c8">3.28.2. Refactor the code</a></li>
<li><a href="#orgbab978d">3.28.3. Pass a test</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org87bbc61">4. Database</a>
<ul>
<li><a href="#org5861a72">4.1. Refactorings</a>
<ul>
<li><a href="#org1aec46f">4.1.1. Add CRUD Methods</a></li>
<li><a href="#org429d080">4.1.2. Add Foreign Key Constraint</a></li>
<li><a href="#org47ff763">4.1.3. Add Lookup Table</a></li>
<li><a href="#orgca79617">4.1.4. Add Mirror Table</a></li>
<li><a href="#org30d9ef2">4.1.5. Add Parameter</a></li>
<li><a href="#orgae30c86">4.1.6. Add Read Method</a></li>
<li><a href="#org372b99a">4.1.7. Add Trigger For Calculated Column</a></li>
<li><a href="#org4a20903">4.1.8. Apply Standard Codes</a></li>
<li><a href="#org088cbad">4.1.9. Apply Standard Type</a></li>
<li><a href="#org7f37c80">4.1.10. Consolidate Conditional Expression</a></li>
<li><a href="#org9f13777">4.1.11. Consolidate Key Strategy</a></li>
<li><a href="#org44db7c6">4.1.12. Decompose Conditional</a></li>
<li><a href="#org3097027">4.1.13. Drop Column</a></li>
<li><a href="#org25277fa">4.1.14. Drop Column Constraint</a></li>
<li><a href="#orgfc1ca48">4.1.15. Drop Default Value</a></li>
<li><a href="#orgbe39040">4.1.16. Drop Foreign Key Constraint</a></li>
<li><a href="#org46e0180">4.1.17. Drop Non-Nullable</a></li>
<li><a href="#org6fc0f9f">4.1.18. Drop Table</a></li>
<li><a href="#org921b28f">4.1.19. Drop View</a></li>
<li><a href="#orgf5f9ff0">4.1.20. Encapsulate Table With View</a></li>
<li><a href="#orgeee4dc4">4.1.21. Extract Method</a></li>
<li><a href="#org826aa99">4.1.22. Introduce Calculated Column</a></li>
<li><a href="#org9703a39">4.1.23. Introduce Calculation Method</a></li>
<li><a href="#org4568240">4.1.24. Introduce Cascading Delete</a></li>
<li><a href="#org29bb766">4.1.25. Introduce Column Constraint</a></li>
<li><a href="#org4653a79">4.1.26. Introduce Common Format</a></li>
<li><a href="#orge01e660">4.1.27. Introduce Default Value</a></li>
<li><a href="#orga8d054b">4.1.28. Introduce Hard Delete</a></li>
<li><a href="#org616a308">4.1.29. Introduce Index</a></li>
<li><a href="#org4b951c7">4.1.30. Introduce New Column</a></li>
<li><a href="#org567770b">4.1.31. Introduce New Table</a></li>
<li><a href="#org71e29dd">4.1.32. Introduce Read-Only Table</a></li>
<li><a href="#org237fa32">4.1.33. Introduce Soft Delete</a></li>
<li><a href="#orgc0d67a5">4.1.34. Introduce Surrogate Key</a></li>
<li><a href="#orgaeda5e4">4.1.35. Introduce Trigger For History</a></li>
<li><a href="#orgf020839">4.1.36. Introduce Variable</a></li>
<li><a href="#orga54b4d7">4.1.37. Introduce View</a></li>
<li><a href="#orgd06ed35">4.1.38. Make Column Non-Nullable</a></li>
<li><a href="#orgeaa561e">4.1.39. Merge Columns</a></li>
<li><a href="#orgf4add75">4.1.40. Merge Tables</a></li>
<li><a href="#orge9f248d">4.1.41. Migrate Method From Database</a></li>
<li><a href="#org9f17f34">4.1.42. Migrate Method To Database</a></li>
<li><a href="#orgcffc1a4">4.1.43. Move Column</a></li>
<li><a href="#orgc9c5dc6">4.1.44. Move Data</a></li>
<li><a href="#org1034ba9">4.1.45. Parameterize Method</a></li>
<li><a href="#org7057928">4.1.46. Remove Control Flag</a></li>
<li><a href="#org31f5e20">4.1.47. Remove Middle Man</a></li>
<li><a href="#org4229ec8">4.1.48. Remove Parameter</a></li>
<li><a href="#org94d25db">4.1.49. Rename Column</a></li>
<li><a href="#orgd7c0a5f">4.1.50. Rename Method</a></li>
<li><a href="#org67d67ea">4.1.51. Rename Table</a></li>
<li><a href="#orgde3b182">4.1.52. Rename View</a></li>
<li><a href="#orga005565">4.1.53. Reorder Parameters</a></li>
<li><a href="#orgc8bc0d4">4.1.54. Replace Column</a></li>
<li><a href="#orgfe30bcd">4.1.55. Replace LOB With Table</a></li>
<li><a href="#orgb50e6f9">4.1.56. Replace Literal With Table Lookup</a></li>
<li><a href="#org52e158f">4.1.57. Replace Method(s) With View</a></li>
<li><a href="#orgd75485c">4.1.58. Replace Nested Conditional With Guard Clauses</a></li>
<li><a href="#org4bfd9da">4.1.59. Replace One-To-Many With Associative Table</a></li>
<li><a href="#org5e601cb">4.1.60. Replace Parameter With Explicit Methods</a></li>
<li><a href="#orgfeea758">4.1.61. Replace Surrogate Key With Natural Key</a></li>
<li><a href="#orgcce90d6">4.1.62. Replace Type Code With Property Flags</a></li>
<li><a href="#org0f2a9f3">4.1.63. Replace View With Method(s)</a></li>
<li><a href="#org6e41ecb">4.1.64. Split Column</a></li>
<li><a href="#orga7fdb2d">4.1.65. Split Table</a></li>
<li><a href="#org6cc730e">4.1.66. Split Temporary Variable</a></li>
<li><a href="#orgb2d6a6b">4.1.67. Substitute Algorithm</a></li>
<li><a href="#org1cdf2de">4.1.68. Update Data</a></li>
<li><a href="#org78c9b5c">4.1.69. Use Official Data Source</a></li>
</ul>
</li>
<li><a href="#orga8ea414">4.2. Links</a></li>
</ul>
</li>
<li><a href="#orgc7c3700">5. <span class="todo TODO">TODO</span> Smells</a>
<ul>
<li><a href="#org854345d">5.1. Booch’s fundamental design principles</a>
<ul>
<li><a href="#org78c5b91">5.1.1. abstraction</a></li>
<li><a href="#org8ad0bf0">5.1.2. encapsulation</a></li>
<li><a href="#org43db3dc">5.1.3. modularization</a></li>
<li><a href="#org7f65a35">5.1.4. hierarchy</a></li>
</ul>
</li>
<li><a href="#org6795a9e">5.2. Normal</a>
<ul>
<li><a href="#org857cf06">5.2.1. Alias Duplicates</a></li>
<li><a href="#org967dc80">5.2.2. Alternative Classes With Different Interfaces</a></li>
<li><a href="#org8915bf3">5.2.3. Comments</a></li>
<li><a href="#org977b0c1">5.2.4. Data Class</a></li>
<li><a href="#orgc98b96a">5.2.5. Data Clumps</a></li>
<li><a href="#org6a529e4">5.2.6. Divergent Change</a></li>
<li><a href="#orgcf17a39">5.2.7. Duplicated Code</a></li>
<li><a href="#org3c88083">5.2.8. Feature Envy</a></li>
<li><a href="#org31af9f8">5.2.9. Global Data</a></li>
<li><a href="#org8496c18">5.2.10. Insider Trading</a></li>
<li><a href="#org0386bb1">5.2.11. Large Class</a></li>
<li><a href="#org5334d45">5.2.12. Lazy Element</a></li>
<li><a href="#org2293e96">5.2.13. Long Function</a></li>
<li><a href="#orgee215b1">5.2.14. Long Parameter List</a></li>
<li><a href="#org3eab08e">5.2.15. Loops</a></li>
<li><a href="#org29eb9a2">5.2.16. Message Chains</a></li>
<li><a href="#orgc009695">5.2.17. Middle Man</a></li>
<li><a href="#orge0d4acf">5.2.18. Mysterious Name</a></li>
<li><a href="#org7a1859f">5.2.19. Primitive Obsession</a></li>
<li><a href="#org304a446">5.2.20. Refused Bequest</a></li>
<li><a href="#org755471b">5.2.21. Repeated Switches</a></li>
<li><a href="#org8e9071b">5.2.22. Shotgun Surgery</a></li>
<li><a href="#orgb1e1c91">5.2.23. Speculative Generality</a></li>
<li><a href="#org3c5c718">5.2.24. Temporary Field</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb0d9d54">6. Codebases</a>
<ul>
<li><a href="#org8e13547">6.1. Video Rental Shop</a></li>
<li><a href="#orgff2a8ef">6.2. Legacy Code Retreat - Trivia Game</a></li>
</ul>
</li>
<li><a href="#orga268efa">7. Tools</a>
<ul>
<li><a href="#org0dc551a">7.1. serializer</a></li>
</ul>
</li>
<li><a href="#orgb4b23c8">8. Jokes</a></li>
<li><a href="#org4ca8357">9. Metrics</a>
<ul>
<li><a href="#org7188248">9.1. Cyclomatic Complexity Number (CCN)</a></li>
<li><a href="#orgf6cdc78">9.2. NPath Complexity</a></li>
</ul>
</li>
<li><a href="#org089d6f6">10. About</a></li>
</ul>
</div>
</div>

<div id="outline-container-org917b849" class="outline-2">
<h2 id="org917b849"><span class="section-number-2">1</span> Books</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgd44073d" class="outline-3">
<h3 id="orgd44073d"><span class="section-number-3">1.1</span> Wake, William C.; Refactoring Workbook; 2003</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orga2da40c" class="outline-4">
<h4 id="orga2da40c"><span class="section-number-4">1.1.1</span> <a href="https://xp123.com/articles/refactoring-workbook/">https://xp123.com/articles/refactoring-workbook/</a></h4>
<div class="outline-text-4" id="text-1-1-1">
</div>
<ol class="org-ol">
<li><a id="orgdb90de6"></a>Taxonomy<br />
<ol class="org-ol">
<li><a id="org1c5ceb1"></a><a href="http://mikamantyla.eu/BadCodeSmellsTaxonomy.html">Mika Mäntylä</a><br /></li>
<li><a id="org8e01f83"></a><a href="http://www.industriallogic.com/wp-content/uploads/2005/09/smellstorefactorings.pdf">Joshua Kerievsky</a><br />
<div class="outline-text-6" id="text-1-1-1-1-2">
<p>
przerwałem bo mam tylko draft a nie pełną książke
</p>
</div>
</li>
</ol>
</li>
</ol>
</div>
</div>
<div id="outline-container-org973d694" class="outline-3">
<h3 id="org973d694"><span class="section-number-3">1.2</span> Working effectivly with legacy code</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>To me, legacy code is simply code without tests. I’ve gotten some grief for</li>
</ul>
<p>
this definition. What do tests have to do with whether code is bad? To me, the
answer is straightforward, and it is a point that I elaborate throughout the
book:
</p>

<p>
'Code without tests is bad code. It doesn’t matter how well written it is; it doesn’t matter how pretty or object-oriented or well-encapsulated it is. With tests, we can change the behavior of our code quickly and verifiably. Without them, we really don’t know if our code is getting better or worse.'
</p>

<p>
being able to confidently make changes in any code base.
</p>

<p>
Preserving existing behavior
</p>

<p>
Changes in a system can be made in two primary ways. I like to call them Edit
and Pray and Cover and Modify. Unfortunately, Edit and Pray is pretty much
the industry standard. When you use Edit and Pray, you carefully plan the
changes you are going to make, you make sure that you understand the code
you are going to modify, and then you start to make the changes. When you’re
done, you run the system to see if the change was enabled, and then you poke
around further to make sure that you didn’t break anything. The poking
around is essential. When you make your changes, you are hoping and praying
that you’ll get them right, and you take extra time when you are done to make
sure that you did.
</p>

<p>
&#x2026;testing is a tough problem, and people are often seduced by the idea that they can test through a GUI or web interface without having to do anything special to their
application. It can be done, but it is usually more work than anyone on a team
is prepared to admit. In addition, a user interface often isn’t the best place to
write tests. UIs are often volatile and too far from the functionality being tested.
When UI-based tests fail, it can be hard to figure out why. Regardless, people
often spend considerable money trying to do all of their testing with those sorts
of tools.
</p>

<p>
Pay now or pay more later
</p>
</div>
</div>

<div id="outline-container-orgb65e7a0" class="outline-3">
<h3 id="orgb65e7a0"><span class="section-number-3">1.3</span> Fowler, Martin; 2018</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>With any introductory example, however, I run into a problem. If I pick a large program, describing it and how it is refactored is too complicated for a mortal reader to work through.(&#x2026;) However, if I pick a program that is small enough to be comprehensible, refactoring does not look like it is worthwhile.</li>

<li>Thus, if I’m faced with modifying a program with hundreds of lines of code, I’d rather it be structured into a set of functions and other program elements that allow me to understand more easily what the program is doing. If the program lacks structure, it’s usually easier for me to add structure to the program first, and then make the change I need.</li>

<li>If the code works and doesn’t ever need to change, it’s perfectly fine to leave it alone. It would be nice to improve it, but unless someone needs to understand it, it isn’t causing any real harm. Yet as soon as someone does need to understand how that code works, and struggles to follow it, then you have to do something about it.</li>

<li>Refactoring changes the programs in small steps, so if you make a mistake, it is easy to find where the bug is.</li>

<li>Any fool can write code that a computer can understand. Good programmers write code that humans can understand.</li>

<li>The true test of good code is how easy it is to change it.</li>

<li>Refactoring (noun): a change made to the internal structure of software to make it easier to understand and cheaper to modify without changing its observable behavior</li>

<li>Refactoring (verb): to restructure software by applying a series of refactorings without changing its observable behavior.</li>

<li>Refactoring is very similar to performance optimization, as both involve carrying out code manipulations that don’t change the overall functionality of the program. The difference is the purpose: Refactoring is always done to make the code “easier to understand and cheaper to modify.” This might speed things up or slow things down. With performance optimization, I only care about speeding up the program, and am prepared to end up with code that is harder to work with if I really need that improved performance.</li>

<li>Without refactoring, the internal design—the architecture—of software tends to decay.As people change code to achieve short­term goals, often without a full comprehensionof the architecture, the code loses its structure. It becomes harder for me to see thedesign by reading the code. Loss of the structure of code has a cumulative effect. Theharder it is to see the design in the code, the harder it is for me to preserve it, and themore rapidly it decays. Regular refactoring helps keep the code in shape.</li>

<li>It reminds me of a statement Kent Beck often makes about himself: “I’m not a great programmer; I’m just a good programmer with great habits.” Refactoring helps me be much more effective at writing robust code.</li>

<li>Branches. As I write this, a common approach in teams is for each team member to work on abranch of the code base using a version control system, and do considerable work onthat branch before integrating with a mainline (often called master or trunk) sharedacross the team. Often, this involves building a whole feature on a branch, notintegrating into the mainline until the feature is ready to be released into production.Fans of this approach claim that it keeps the mainline clear of any in­process code,provides a clear version history of feature additions, and allows features to be revertedeasily should they cause problems.There are downsides to feature branches like this. The longer I work on an isolatedbranch, the harder the job of integrating my work with mainline is going to be when I’mdone. Most people reduce this pain by frequently merging or re­basing from mainlineto my branch. But this doesn’t really solve the problem when several people areworking on individual feature branches. I distinguish between merging and integration.If I merge mainline into my code, this is a oneway movement—my branch changes butthe mainline doesn’t. I use “integrate” to mean a two­way process that pulls changesfrom mainline into my branch and then pushes the result back into mainline, changingboth. If Rachel is working on her branch I don’t see her changes until she integrateswith mainline; at that point, I have to merge her changes into my feature branch, whichmay mean considerable work. The hard part of this work is dealing with semanticchanges. Modern version control systems can do wonders with merging complexchanges to the program text, but they are blind to the semantics of the code. If I’vechanged the name of a function, my version control tool may easily integrate mychanges with Rachel’s. But if, in her branch, she added a call to a function that I’verenamed in mine, the code will fail.The problem of complicated merges gets exponentially worse as the length of featurebranches increases. Integrating branches that are four weeks old is more than twice ashard as those that are a couple of weeks old. Many people, therefore, argue for keepingfeature branches short—perhaps just a couple of days. Others, such as me, want themeven shorter than that. This is an approach called Continuous Integration (CI), alsoknown as Trunk­Based Development. With CI, each team member integrates withmainline at least once per day. This prevents any branches diverting too far from eachother and thus greatly reduces the complexity of merges. CI doesn’t come for free: Itmeans you use practices to ensure the mainline is healthy, learn to break large featuresinto smaller chunks, and use feature toggles (aka feature flags) to switch off any in­process features that can’t be broken down.Fans of CI like it partly because it reduces the complexity of merges, but the dominantreason to favor CI is that it’s far more compatible with refactoring. Refactorings ofteninvolve making lots of little changes all over the code base—which are particularlyprone to semantic merge conflicts (such as renaming a widely used function). Many ofus have seen feature­branching teams that find refactorings so exacerbate mergeproblems that they stop refactoring. CI and re­factoring work well together, which iswhy Kent Beck combined them in Extreme Programming.I’m not saying that you should never use feature branches. If they are sufficiently short,their problems are much reduced. (Indeed, users of CI usually also use branches, butintegrate them with mainline each day.) Feature branches may be the right techniquefor open source projects where you have infrequent commits from programmers whoyou don’t know well (and thus don’t trust). But in a full­time development team, thecost that feature branches impose on refactoring is excessive. Even if you don’t go to fullCI, I certainly urge you to integrate as frequently as possible. You should also considerthe objective evidence [Forsgren et al.] that teams that use CI are more effective insoftware delivery.</li>
</ul>



<p>
131
</p>
</div>
</div>
<div id="outline-container-org5dd845a" class="outline-3">
<h3 id="org5dd845a"><span class="section-number-3">1.4</span> Feathers, Michael; Working Effectively with Legacy Code; 2005</h3>
</div>
<div id="outline-container-org15fbb27" class="outline-3">
<h3 id="org15fbb27"><span class="section-number-3">1.5</span> Others</h3>
<div class="outline-text-3" id="text-1-5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">author</th>
<th scope="col" class="org-left">title</th>
<th scope="col" class="org-left">topic</th>
<th scope="col" class="org-left">info</th>
<th scope="col" class="org-right">year</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Andrew Hunt, David Thomas</td>
<td class="org-left">The Pragmatic Programmer: From Journeyman to Master</td>
<td class="org-left">overall</td>
<td class="org-left">skip</td>
<td class="org-right">1999</td>
<td class="org-left">a lot of tips &amp; tricks but too old</td>
</tr>

<tr>
<td class="org-left">William J. Brown, Raphael C. Malveau, Hays W. "Skip" McCormick, Thomas J. Mowbray</td>
<td class="org-left">Antipatterns. Refactoring Software, Archtectures and Projects in Crisis</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">1998</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Refactoring in Large Software Projects</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2006</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Phillip A. Laplante, Colin J. Neill</td>
<td class="org-left">Antipatterns: Identification, Refactoring, and Management</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2005</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Fifty Quick Ideas To Improve Your Tests</td>
<td class="org-left">tests</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Growing Object-Oriented Software, Guided by Tests</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Working Effectively with Unit Tests</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Scalable Internet Architectures</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">SQL for Smarties: Advanced SQL Programming</td>
<td class="org-left">database</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2005</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Mastering the SPL Library</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Anthology  The Thoughtworks Anthology - Essays on Software Technology and Innovation</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2008</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Anthology  The ThoughtWorks Anthology 2 - More Essays on Software Technology and Innovation</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2012</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Beck, Kent</td>
<td class="org-left">Extreme Programming Explained: Embrace Change</td>
<td class="org-left">overall</td>
<td class="org-left">can be read</td>
<td class="org-right">1999</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Bernstein, David Scott</td>
<td class="org-left">Beyond Legacy Code</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2015</td>
<td class="org-left">Want to read</td>
</tr>

<tr>
<td class="org-left">Bhargava, Aditya</td>
<td class="org-left">Grokking Algorithms: An illustrated guide for programmers and other curious people</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">must read</td>
<td class="org-right">2017</td>
<td class="org-left">Fully illustrated, friendly, easy to read guide, worth to read. When you will stumble upon a problem, you will know how to recognize it and chose the right Algorithm</td>
</tr>

<tr>
<td class="org-left">Bloch, Joshua</td>
<td class="org-left">Effective Java</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2018</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Buenosvinos, Carlos</td>
<td class="org-left">Domain-Driven Design in PHP</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2016</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Bugayenko, Yegor</td>
<td class="org-left">Elegant Objects</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2016</td>
<td class="org-left">Want to read</td>
</tr>

<tr>
<td class="org-left">Fowler, Martin</td>
<td class="org-left">Refactoring: Improving the Design of Existing Code</td>
<td class="org-left">refactoring</td>
<td class="org-left">must have</td>
<td class="org-right">1999</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Fowler, Martin</td>
<td class="org-left">Patterns of Enterprise Application Architecture</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2012</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Francesco Trucchia, Jacopo Romei</td>
<td class="org-left">Pro PHP Refactoring</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2010</td>
<td class="org-left">Old, without PHP 7 but still the best PHP book about refactoring. Great examples. Worth to have.</td>
</tr>

<tr>
<td class="org-left">Ganesh, Samarthyam; Tushar, Sharma</td>
<td class="org-left">Refactoring for Software Design Smells: Managing Technical Debt</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2015</td>
<td class="org-left">Catalog of smells. Focus on smell point of view. Also they introduce smell classification scheme, naming scheme for design smells which helps to increase awerness of smells. So definetly must read. (Java)</td>
</tr>

<tr>
<td class="org-left">Halladay, Steve</td>
<td class="org-left">Principle-Based Refactoring: Learning Software Design Principles by Applying Refactoring Rules</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2012</td>
<td class="org-left">Want to read</td>
</tr>

<tr>
<td class="org-left">Jones, Paul M.</td>
<td class="org-left">Modernizing Legacy Apps In PHP</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2014</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Junade, Ali</td>
<td class="org-left">Mastering PHP Design Patterns</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2016</td>
<td class="org-left">Little bit inmature, poorly written. Having a lot of tips and information about broad variaty of things which is a good place on website but not in the book. Code examples could be much better.</td>
</tr>

<tr>
<td class="org-left">Karwin, Bill</td>
<td class="org-left">SQL Antipatterns - Avoiding The Pitfalls of Database Programming</td>
<td class="org-left">database</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2010</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Kerievsky, Joshua</td>
<td class="org-left">Refactoring to Patterns</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2004</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Martin, Robert C.</td>
<td class="org-left">Agile Software Development: Principles, Patterns, and Practices</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2002</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Martin, Robert C.</td>
<td class="org-left">Clean Code: A Handbook of Agile Software Craftsmanship</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2009</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Rahman, Mizanur</td>
<td class="org-left">PHP 7 Data Structures and Algorithms</td>
<td class="org-left">refactoring</td>
<td class="org-left">must have</td>
<td class="org-right">2017</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Scott J Ambler and Pramod J. Sadalage</td>
<td class="org-left">Refactoring Databases - Evolutionary Database Design</td>
<td class="org-left">refactoring</td>
<td class="org-left">must read</td>
<td class="org-right">2006</td>
<td class="org-left">It's catalog of refactorings for database</td>
</tr>

<tr>
<td class="org-left">Stephane Faroult, Pascal L'Hermite</td>
<td class="org-left">Refactoring SQL Application</td>
<td class="org-left">database</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2008</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Tornhill, Adam</td>
<td class="org-left">Your Code as a Crime Scene - Use Forensic Techniques to Arrest Defects, Bottlenecks, and Bad Design in Your Programs</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2015</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">West, David</td>
<td class="org-left">Object Thinking</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">2004</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Zandstra, Matt</td>
<td class="org-left">PHP Objects, Patterns, and Practice</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">can be read</td>
<td class="org-right">2008</td>
<td class="org-left">Pretty old. But written with precise language and with great examples</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orgf96e04b" class="outline-2">
<h2 id="orgf96e04b"><span class="section-number-2">2</span> Tutorials</h2>
<div class="outline-text-2" id="text-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><a href="https://www.pluralsight.com/courses/automated-tests-phpunit">Automated Tests with PHPUnit</a></td>
<td class="org-left">Anna Filina</td>
<td class="org-left">testing - PHPUnit</td>
</tr>

<tr>
<td class="org-left"><a href="https://industriallogic.com/xp/refactoring/catalog.html">Catalog of Refactoring to Patterns</a></td>
<td class="org-left">Joshua Kerievsky</td>
<td class="org-left">patterns</td>
</tr>

<tr>
<td class="org-left"><a href="https://refactoring.com/catalog/">Catalog of Refactorings</a></td>
<td class="org-left">Martin Fowler</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/bkjIEywt45Y">Clean Application Development</a></td>
<td class="org-left">Adam Culp</td>
<td class="org-left">clean application</td>
</tr>

<tr>
<td class="org-left"><a href="https://github.com/jupeter/clean-code-php">Clean Code PHP</a></td>
<td class="org-left">Piotr Plenik</td>
<td class="org-left">clean code</td>
</tr>

<tr>
<td class="org-left"><a href="https://code.tutsplus.com/courses/detecting-code-smells">Detecting Code Smells</a></td>
<td class="org-left">Patkós Csaba</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/WW2qPKukoZY">Doctrine Best Practices</a></td>
<td class="org-left">Marco Pivetta (Ocramius)</td>
<td class="org-left">doctrine</td>
</tr>

<tr>
<td class="org-left"><a href="https://www.pluralsight.com/courses/encapsulation-solid">Encapsulation and SOLID</a></td>
<td class="org-left">Mark Seemann</td>
<td class="org-left">SOLID</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/7LoShYRnljU">Extremely Defensive PHP Programming</a></td>
<td class="org-left">Marco Pivetta (Ocramius)</td>
<td class="org-left">defensive programming</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/Rdc3r2BJzWA">How to Refactor Like a Boss 1</a></td>
<td class="org-left">Michael Cheng</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/2iXayIx4WyQ">How to Refactor Like a Boss 2</a></td>
<td class="org-left">Michael Cheng</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/JCqbdVrIW30">HTTP Smoke Testing</a></td>
<td class="org-left">Peter Heinz</td>
<td class="org-left">testing - smoke test</td>
</tr>

<tr>
<td class="org-left"><a href="https://www.udemy.com/introduction-to-testing-with-phpunit/">Introduction to Testing with PHPUnit</a></td>
<td class="org-left">Trevor Sawler</td>
<td class="org-left">testing - PHPUnit</td>
</tr>

<tr>
<td class="org-left"><a href="http://blog.adrianbolboaca.ro/2014/04/legacy-coderetreat/#sessions">Legacy Coderetreat (Java)</a></td>
<td class="org-left">Adrian Bolboaca</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://github.com/exakat/php-static-analysis-tools">List of Static Analysis Tools</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">analysis</td>
</tr>

<tr>
<td class="org-left"><a href="https://www.lynda.com/PHP-tutorials/PHP-Testing-Legacy-Applications/669546-2.html">PHP: Testing Legacy Applications</a></td>
<td class="org-left">Chris Hartjes</td>
<td class="org-left">testing - PHPUnit</td>
</tr>

<tr>
<td class="org-left"><a href="https://knpuniversity.com/screencast/phpunit">PHPUnit: Testing with a Bite</a></td>
<td class="org-left">Ryan Weaver</td>
<td class="org-left">testing - PHPUnit</td>
</tr>

<tr>
<td class="org-left"><a href="https://www.lynda.com/Developer-Programming-Foundations-tutorials/Foundations-Programming-Refactoring-Code/122457-2.html">Programming Foundations: Refactoring Code</a></td>
<td class="org-left">Simon Allardice</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://www.lynda.com/Software-Development-tutorials/Programming-Foundations-Test-Driven-Development/124398-2.html">Programming Foundations: Test-Driven Development</a></td>
<td class="org-left">Simon Allardice</td>
<td class="org-left">testing - TDD</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/0DYIJdX6kB4">Refactoring 101</a></td>
<td class="org-left">Adam Culp</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://code.tutsplus.com/series/refactoring-legacy-code--cms-633">Refactoring Legacy Code</a></td>
<td class="org-left">Patkós Csaba</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/7v9ehGsPm1s">Refactoring Legacy Code</a></td>
<td class="org-left">Adam Culp</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://adamwathan.me/refactoring-to-collections/">Refactoring to Collections</a></td>
<td class="org-left">Adam Wathan</td>
<td class="org-left">collections</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/Fca-Ng0bzuk">Solving the N+1 Problem</a></td>
<td class="org-left">Paul M. Jones</td>
<td class="org-left">database</td>
</tr>

<tr>
<td class="org-left"><a href="https://youtu.be/65NrzJ_5j58">Steps Toward Modernizing a Legacy Codebase</a></td>
<td class="org-left">Paul M. Jones</td>
<td class="org-left">refactoring</td>
</tr>

<tr>
<td class="org-left"><a href="https://code.tutsplus.com/courses/techniques-for-refactoring-code">Techniques for Refactoring Code</a></td>
<td class="org-left">Patkós Csaba</td>
<td class="org-left">refactoring</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgdcf1171" class="outline-2">
<h2 id="orgdcf1171"><span class="section-number-2">3</span> Refactorings</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orga42279e" class="outline-3">
<h3 id="orga42279e"><span class="section-number-3">3.1</span> Add PHPDoc</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Smell: An array with elements of generic type or method which can throw Exception
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printUsersNames</span>(<span style="color: #7fffd4;">array</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">users</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #ffffff;">foreach</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">users</span> <span style="color: #ffffff;">as</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">user</span>) {
        <span style="color: #ffffff;">echo</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">user</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getName</span>();
    }
}
</pre>
</div>
</div>
<div id="outline-container-org23e28ca" class="outline-4">
<h4 id="org23e28ca"><span class="section-number-4">3.1.1</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Add PHPDoc - the Object[] notation in addition to an array type-hint to explain what kind of object is expected
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;"> * </span><span style="color: #40e0d0;">@param</span><span style="color: #bdb76b;"> </span><span style="color: #bdb76b;">User[]</span><span style="color: #bdb76b;"> </span><span style="color: #9acd32;">$</span><span style="color: #9acd32;">users</span>
<span style="color: #bdb76b;"> */</span>
<span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printUsersNames</span>(<span style="color: #7fffd4;">array</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">users</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #ffffff;">foreach</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">users</span> <span style="color: #ffffff;">as</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">user</span>) {
        <span style="color: #ffffff;">echo</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">user</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getName</span>();
    }
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc8cab55" class="outline-3">
<h3 id="orgc8cab55"><span class="section-number-3">3.2</span> Add Type-Hint</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Smell: A method with no type defined parameters or return type declaration
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">setNumber</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>)
{
    <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">number</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>;
}
</pre>
</div>
</div>
<div id="outline-container-org752f04c" class="outline-4">
<h4 id="org752f04c"><span class="section-number-4">3.2.1</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">setNumber</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">number</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org8d2998f" class="outline-4">
<h4 id="org8d2998f"><span class="section-number-4">3.2.2</span> Helper</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
<a href="https://github.com/dunglas/phpdoc-to-typehint">phpdoc-to-typehint</a> adds automatically scalar type hints and return types to all functions and methods using existing PHPDoc annotations 
</p>
</div>
</div>
<div id="outline-container-org3f0d142" class="outline-4">
<h4 id="org3f0d142"><span class="section-number-4">3.2.3</span> Further Reading</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
<a href="https://www.thecodingmachine.com/type-hint-all-the-things/">https://www.thecodingmachine.com/type-hint-all-the-things/</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org07370f4" class="outline-3">
<h3 id="org07370f4"><span class="section-number-3">3.3</span> Consolidate Conditional Expression</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Smell: Sequence of conditionals with the same result
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Sale</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateShipping</span>(<span style="color: #7fffd4;">Customer</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span>)
    {
        <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">isEmployee</span>) <span style="color: #ffffff;">return</span> 0;
        <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">isGoldCustomer</span>) <span style="color: #ffffff;">return</span> 0;
        <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">isHasACoupon</span>) <span style="color: #ffffff;">return</span> 0;
        
        <span style="color: #ffffff;">if</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">isUsa</span>) <span style="color: #ffffff;">return</span> 10;
        <span style="color: #ffffff;">if</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">isEurope</span>) <span style="color: #ffffff;">return</span> 20;
    }
}
</pre>
</div>
</div>
<div id="outline-container-org3bb09eb" class="outline-4">
<h4 id="org3bb09eb"><span class="section-number-4">3.3.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org310dd22" class="outline-4">
<h4 id="org310dd22"><span class="section-number-4">3.3.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
Combine them into a single conditional expression and extract it.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Sale</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateShipping</span>(<span style="color: #7fffd4;">Customer</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span>): <span style="color: #7fffd4;">int</span>
    {
       <span style="color: #ffffff;">if</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">isFreeShipping</span>()){
           <span style="color: #ffffff;">return</span> 0;
       }

        <span style="color: #ffffff;">if</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">isUsa</span>) {
            <span style="color: #ffffff;">return</span> 10;
        }

        <span style="color: #ffffff;">if</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">isEurope</span>) {
            <span style="color: #ffffff;">return</span> 20;
        }
    }

    <span style="color: #ffffff;">private</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">isFreeShipping</span>(): <span style="color: #7fffd4;">bool</span>
    {
        <span style="color: #ffffff;">return</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">isEmployee</span> || <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">isGoldCustomer</span> || <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">customer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">isHasACoupon</span>);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb9763b5" class="outline-4">
<h4 id="orgb9763b5"><span class="section-number-4">3.3.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org554906d" class="outline-3">
<h3 id="org554906d"><span class="section-number-3">3.4</span> Consolidate Duplicate Conditional Fragments</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Smell: The same fragment of code is in all branches of a conditional expression.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Sale</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateTotal</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">price</span>)
    {
        <span style="color: #ffffff;">if</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">isSpecialDeal</span>()) {
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">price</span> * 0.95;
            <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">setTotal</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span>);
        }
        <span style="color: #ffffff;">else</span> {
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">price</span> * 0.98;
            <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">setTotal</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span>);
        }
    }
}
</pre>
</div>
</div>
<div id="outline-container-org261670f" class="outline-4">
<h4 id="org261670f"><span class="section-number-4">3.4.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org3241b05" class="outline-4">
<h4 id="org3241b05"><span class="section-number-4">3.4.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
Move it outside of the expression.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Sale</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateTotal</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">price</span>)
    {
        <span style="color: #ffffff;">if</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">isSpecialDeal</span>()) {
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">price</span> * 0.95;
        }
        <span style="color: #ffffff;">else</span> {
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">price</span> * 0.98;
        }

        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">setTotal</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">total</span>);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgde9b6fb" class="outline-4">
<h4 id="orgde9b6fb"><span class="section-number-4">3.4.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org72e7c4a" class="outline-3">
<h3 id="org72e7c4a"><span class="section-number-3">3.5</span> Decompose Conditional</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Smell: Complicated conditional (if-else) statement.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Sale</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">expired_at</span>;
    <span style="color: #ffffff;">public</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getAmount</span>()
    {
        <span style="color: #ffffff;">if</span>(<span style="color: #40e0d0;">null</span> !== <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">expired_at</span> &amp;&amp; <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">expired_at</span> &lt; time())
        {
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">interest</span> = 10;
            <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> = <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> + (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> / 100 * <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">interest</span>);
        }
        <span style="color: #ffffff;">else</span>
        {
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">discount</span> = 10;
            <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> = <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> - (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> / 100 * <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">discount</span>);
        }
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span>;
    }
}
</pre>
</div>
</div>
<div id="outline-container-org974a9e3" class="outline-4">
<h4 id="org974a9e3"><span class="section-number-4">3.5.1</span> Write a test that pass</h4>
<div class="outline-text-4" id="text-3-5-1">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">SaleTest</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">TestCase</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">testAmount</span>()
    {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">Sale</span>();
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> = 10;
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">expired_at</span> = strtotime(<span style="color: #bdb76b;">'-10 days'</span>);
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">assertEquals</span>(10 + (10 / 100 * 10), <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getAmount</span>());
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">Sale</span>();

        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> = 10;
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">expired_at</span> = strtotime(<span style="color: #bdb76b;">'+10 days'</span>);
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">assertEquals</span>(10 - (10 / 100 * 10), <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">sale</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getAmount</span>());
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orge6fb2a0" class="outline-4">
<h4 id="orge6fb2a0"><span class="section-number-4">3.5.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
Extract conditional code in a private method. We name the method isExpired() because our conditional chunk of code checks if the sale is expired. We create the private method isExpired() and, with the technique of extract method, we move chunks of code into the new method. The next step is to move each branch of the condition in a private method. We do the same as we did before for each branch. So we create the private method getAmountWithInterest() for the first branch and the method getAmountWithDiscount() for the second branch.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Sale</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">expired_at</span>;
    <span style="color: #ffffff;">public</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getAmount</span>()
    {
        <span style="color: #ffffff;">if</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">isExpired</span>()) {
            <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getAmountWithInterest</span>();
        } <span style="color: #ffffff;">else</span> {
            <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getAmountWithDiscount</span>();
        }
    }

    <span style="color: #ffffff;">private</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">isExpired</span>()
    {
        <span style="color: #ffffff;">return</span> !is_null(<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">expired_at</span>) &amp;&amp; <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">expired_at</span> &lt; time();
    }

    <span style="color: #ffffff;">private</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getAmountWithInterest</span>()
    {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">interest</span> = 10;
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> + (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> / 100 * <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">interest</span>);
    }

    <span style="color: #ffffff;">private</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getAmountWithDiscount</span>()
    {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">discount</span> = 10;
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> - (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">amount</span> / 100 * <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">discount</span>);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org202bb28" class="outline-4">
<h4 id="org202bb28"><span class="section-number-4">3.5.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orge07391a" class="outline-3">
<h3 id="orge07391a"><span class="section-number-3">3.6</span> Encapsulate Field</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Smell: A public field
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">User</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">string</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">public</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
}
</pre>
</div>
</div>
<div id="outline-container-org58fc43e" class="outline-4">
<h4 id="org58fc43e"><span class="section-number-4">3.6.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-orgc164ebb" class="outline-4">
<h4 id="orgc164ebb"><span class="section-number-4">3.6.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-6-2">
<p>
Make it private and provide accessors.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">User</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">string</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getName</span>(): <span style="color: #7fffd4;">string</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">setName</span>(<span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>): <span style="color: #7fffd4;">void</span>
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org7cd1fd7" class="outline-4">
<h4 id="org7cd1fd7"><span class="section-number-4">3.6.3</span> Run a test</h4>
</div>
</div>
<div id="outline-container-orga55c5ea" class="outline-3">
<h3 id="orga55c5ea"><span class="section-number-3">3.7</span> Extract Class</h3>
<div class="outline-text-3" id="text-3-7">
<p>
SmellL Large Class
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">User</span>
{
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">surname</span>;

    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">city</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">zipCode</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">street</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">state</span>;
}
</pre>
</div>
</div>
<div id="outline-container-org6ac1e66" class="outline-4">
<h4 id="org6ac1e66"><span class="section-number-4">3.7.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org6faa696" class="outline-4">
<h4 id="org6faa696"><span class="section-number-4">3.7.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-7-2">
<p>
Create a new class and move the relevant fields and methods from the old class into the new class.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">User</span>
{
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">surname</span>;

    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">address</span>;
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Address</span>
{
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">city</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">zipCode</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">street</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">state</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf188dcc" class="outline-4">
<h4 id="orgf188dcc"><span class="section-number-4">3.7.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orgc25ed1a" class="outline-3">
<h3 id="orgc25ed1a"><span class="section-number-3">3.8</span> Extract Function</h3>
<div class="outline-text-3" id="text-3-8">
<p>
Alias: Extract Method
Inverse of: Inline Function
Smell: Code fragment that can be grouped together
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoice</span>(<span style="color: #7fffd4;">Invoice</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'Invoice'</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'&lt;br&gt;'</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getNumber</span>();
   
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'phpRefactor: '</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'&lt;br&gt;'</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getDate</span>();
}
</pre>
</div>
</div>
<div id="outline-container-orgbb2097d" class="outline-4">
<h4 id="orgbb2097d"><span class="section-number-4">3.8.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org62cbcc8" class="outline-4">
<h4 id="org62cbcc8"><span class="section-number-4">3.8.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-8-2">
<p>
Turn the fragment into a method whose name explains the purpose of the method
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoice</span>(<span style="color: #7fffd4;">Invoice</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span>): <span style="color: #7fffd4;">void</span>
{
    printInvoiceHeader(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span>);
    printInvoiceFooter(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span>);
}

<span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoiceHeader</span>(<span style="color: #7fffd4;">Invoice</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'Invoice'</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'&lt;br&gt;'</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getNumber</span>();
}

<span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoiceFooter</span>(<span style="color: #7fffd4;">Invoice</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'phpRefactor: '</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">'&lt;br&gt;'</span>;
    <span style="color: #ffffff;">echo</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">invoice</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getDate</span>();
}



</pre>
</div>
</div>
</div>
<div id="outline-container-orgb133eb2" class="outline-4">
<h4 id="orgb133eb2"><span class="section-number-4">3.8.3</span> Run a test</h4>
</div>
<div id="outline-container-orgd02d792" class="outline-4">
<h4 id="orgd02d792"><span class="section-number-4">3.8.4</span> Notes</h4>
<div class="outline-text-4" id="text-3-8-4">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoice</span>() {
    <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">footer</span>=<span style="color: #ffffff;">function</span>() {
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"phpRefactor.com \n"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"2019"</span>;
    };
    
    <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Header \n"</span>;
    <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">footer</span>();
}
printInvoice();

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd6d5652" class="outline-3">
<h3 id="orgd6d5652"><span class="section-number-3">3.9</span> Extract Variable</h3>
<div class="outline-text-3" id="text-3-9">
<p>
Alias: Introduce Explaining Variable
Smell: Complicated expression
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">if</span>((<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">stock</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">checkStatus</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">getItem</span>) &gt; <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getQuantity</span>()) 
    &amp;&amp; (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getTotal</span>() &gt; 99) 
    &amp;&amp; (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getCustomer</span>()<span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getBillingAddress</span>() === <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getShippingAddress</span>()));
</pre>
</div>
</div>
<div id="outline-container-orgc090cc8" class="outline-4">
<h4 id="orgc090cc8"><span class="section-number-4">3.9.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org4ffcd2e" class="outline-4">
<h4 id="org4ffcd2e"><span class="section-number-4">3.9.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-9-2">
<p>
Put the result of the expression, or part of it in a temporary variable with a name that explains the purpose
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">freeShipping</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getTotal</span>() &gt; 99;
<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">stockAvailable</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">stock</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">checkStatus</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">getItem</span>) &gt; <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getQuantity</span>();
<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">addressMatches</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getCustomer</span>()<span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getBillingAddress</span>() === <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getShippingAddress</span>();
<span style="color: #ffffff;">if</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">stockAvailable</span> &amp;&amp; <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">freeShipping</span> &amp;&amp; <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">addressMatches</span>);
</pre>
</div>
</div>
</div>
<div id="outline-container-org89a9ddc" class="outline-4">
<h4 id="org89a9ddc"><span class="section-number-4">3.9.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org62c7347" class="outline-3">
<h3 id="org62c7347"><span class="section-number-3">3.10</span> Inline Class</h3>
<div class="outline-text-3" id="text-3-10">
<p>
Smell: A class isn't doing very much
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">User</span>
{
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">surname</span>;

    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">telephoneNumber</span>;
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">TelephoneNumber</span>
{
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org0184481" class="outline-3">
<h3 id="org0184481"><span class="section-number-3">3.11</span> <span class="done DONE">DONE</span> Inline Function</h3>
<div class="outline-text-3" id="text-3-11">
<p>
Smell: A function's body is just as clear as it's name
</p>
<div class="org-src-container">
<pre class="src src-php" id="org6cd135b"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Circle</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">const</span> <span style="color: #40e0d0;">RADIUS</span> = 2;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getArea</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getValueOfPI</span>() * <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">RADIUS</span> * <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">RADIUS</span>;
    }

    <span style="color: #ffffff;">private</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getValueOfPI</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> pi();
    }
}
</pre>
</div>
</div>
<div id="outline-container-org8f0721b" class="outline-4">
<h4 id="org8f0721b"><span class="section-number-4">3.11.1</span> Write a test that pass</h4>
<div class="outline-text-4" id="text-3-11-1">
<div class="org-src-container">
<pre class="src src-phpunit" id="orgc0b53df">
<span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">PHPUnit\Framework\TestCase</span>;

<span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">CircleTest</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">TestCase</span>
{   
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">testGetArea</span>()
    {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">circle</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">Circle</span>();
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">assertEquals</span>( 12.566370614359172, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">circle</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getArea</span>());
    }
}
</pre>
</div>

<pre class="example">
PHPUnit 7.4.3 by Sebastian Bergmann and contributors.

.                                                                   1 / 1 (100%)

Time: 53 ms, Memory: 10.00MB

OK (1 test, 1 assertion)

</pre>
</div>
</div>

<div id="outline-container-orgf0805d9" class="outline-4">
<h4 id="orgf0805d9"><span class="section-number-4">3.11.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-11-2">
<p>
Put the method's body into the body of its callers and remove the method.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getArea</span>(): <span style="color: #7fffd4;">float</span>
{
    <span style="color: #ffffff;">return</span> pi() * <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span> * <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org5c1a1a2" class="outline-4">
<h4 id="org5c1a1a2"><span class="section-number-4">3.11.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orgd32bbe4" class="outline-3">
<h3 id="orgd32bbe4"><span class="section-number-3">3.12</span> Inline Variable</h3>
<div class="outline-text-3" id="text-3-12">
<p>
Smell: Variable name doesn't really communicate more than the expression itself or gets in the way of refactoring neighboring code.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #7fffd4;">let</span> <span style="color: #9acd32;">basePrice</span> = anOrder.basePrice;
<span style="color: #ffffff;">return</span> (basePrice &gt; 1000);
</pre>
</div>
</div>
<div id="outline-container-org47e57ec" class="outline-4">
<h4 id="org47e57ec"><span class="section-number-4">3.12.1</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-12-1">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">return</span> anOrder.basePrice &gt; 1000;
</pre>
</div>
<p>
140
</p>
</div>
</div>
</div>
<div id="outline-container-org3b95258" class="outline-3">
<h3 id="org3b95258"><span class="section-number-3">3.13</span> Introduce Parameter Object</h3>
<div class="outline-text-3" id="text-3-13">
<p>
Smell: Long Parameter List and parameters that naturally go together
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">findAllTransactions</span>(<span style="color: #7fffd4;">DateTime</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">start</span>, <span style="color: #7fffd4;">DateTime</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">end</span>)
    {
        ...
    }
}
</pre>
</div>
</div>
<div id="outline-container-org7fe665e" class="outline-4">
<h4 id="org7fe665e"><span class="section-number-4">3.13.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org4bfa1f6" class="outline-4">
<h4 id="org4bfa1f6"><span class="section-number-4">3.13.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-13-2">
<p>
    Replace them with an object.
#+BEGIN<sub>SRC</sub> php#+END<sub>SRC</sub>
</p>
</div>
</div>
<div id="outline-container-orge0ba1a5" class="outline-4">
<h4 id="orge0ba1a5"><span class="section-number-4">3.13.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orgabccbb2" class="outline-3">
<h3 id="orgabccbb2"><span class="section-number-3">3.14</span> Optimize Imports</h3>
<div class="outline-text-3" id="text-3-14">
<p>
Smell: Imports unused or not in alphabetically order. Multiple use statement
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">SomeClass\Worker</span>;
<span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">SomeClass\Foo</span>;
<span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">SomeClass\UnusedClass</span>;
</pre>
</div>
</div>
<div id="outline-container-org9bc076b" class="outline-4">
<h4 id="org9bc076b"><span class="section-number-4">3.14.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-orgf8cf30d" class="outline-4">
<h4 id="orgf8cf30d"><span class="section-number-4">3.14.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-14-2">
<p>
Remove unused imports. Sort imports alphabetically (ascending order). Splits multiple use statement imports into single use statement imports
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">SomeClass</span>\{Foo, Worker};
</pre>
</div>
</div>
</div>
<div id="outline-container-org4f00cb4" class="outline-4">
<h4 id="org4f00cb4"><span class="section-number-4">3.14.3</span> Pass a test</h4>
</div>
</div>

<div id="outline-container-org7138895" class="outline-3">
<h3 id="org7138895"><span class="section-number-3">3.15</span> Move Method</h3>
<div class="outline-text-3" id="text-3-15">
<p>
Smell: Method accessing fields and methods in different class
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Customer</span>
{
    <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoice</span>(<span style="color: #7fffd4;">Order</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span>)
    {
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Invoice </span><span style="color: #9acd32;">{$order-&gt;getId()}</span><span style="color: #bdb76b;">"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Date: </span><span style="color: #9acd32;">{$order-&gt;getDate()}</span><span style="color: #bdb76b;">"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Customer: </span><span style="color: #9acd32;">{$this-&gt;getName()}</span><span style="color: #bdb76b;">"</span>;

        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">address</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getAddress</span>();
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"City: </span><span style="color: #9acd32;">{$address-&gt;getCity()}</span><span style="color: #bdb76b;">"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Address: </span><span style="color: #9acd32;">{$address-&gt;getStreet()}</span><span style="color: #bdb76b;">"</span>;

        <span style="color: #ffffff;">foreach</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">order</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getItems</span>() <span style="color: #ffffff;">as</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">item</span>){

            <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Name: </span><span style="color: #9acd32;">{$item-&gt;getName()}</span><span style="color: #bdb76b;">"</span>;
            <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Price: </span><span style="color: #9acd32;">{$item-&gt;getPrice()}</span><span style="color: #bdb76b;">"</span>;
        }
    }
}   
</pre>
</div>
</div>
<div id="outline-container-org0f177cc" class="outline-4">
<h4 id="org0f177cc"><span class="section-number-4">3.15.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-orgbac70ea" class="outline-4">
<h4 id="orgbac70ea"><span class="section-number-4">3.15.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-15-2">
<p>
Move all its features into another class and delete it.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Order</span>
{
    <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">printInvoice</span>()
    {
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Invoice </span><span style="color: #9acd32;">{$this-&gt;getId()}</span><span style="color: #bdb76b;">"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Date: </span><span style="color: #9acd32;">{$this-&gt;getDate()}</span><span style="color: #bdb76b;">"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Customer: </span><span style="color: #9acd32;">{$this-&gt;getCustomer()-&gt;getName()}</span><span style="color: #bdb76b;">"</span>;

        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">address</span> = <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getAddress</span>();
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"City: </span><span style="color: #9acd32;">{$address-&gt;getCity()}</span><span style="color: #bdb76b;">"</span>;
        <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Address: </span><span style="color: #9acd32;">{$address-&gt;getStreet()}</span><span style="color: #bdb76b;">"</span>;

        <span style="color: #ffffff;">foreach</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getItems</span>() <span style="color: #ffffff;">as</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">item</span>){

            <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Name: </span><span style="color: #9acd32;">{$item-&gt;getName()}</span><span style="color: #bdb76b;">"</span>;
            <span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Price: </span><span style="color: #9acd32;">{$item-&gt;getPrice()}</span><span style="color: #bdb76b;">"</span>;
        }
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org02c265f" class="outline-4">
<h4 id="org02c265f"><span class="section-number-4">3.15.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org71d1bb3" class="outline-3">
<h3 id="org71d1bb3"><span class="section-number-3">3.16</span> Parameterize Method</h3>
<div class="outline-text-3" id="text-3-16">
<p>
Smell: Several methods do similar things but with different values contained in the method body.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Employee</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">salary</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">setSalary</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">salary</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">salary</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getSalary</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">fivePercentRaise</span>()
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span> += <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span>* (5 / 100);
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">tenPercentRaise</span>()
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span> += <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span>* (10 / 100) ;
    }
}
</pre>
</div>
</div>
<div id="outline-container-org6c86875" class="outline-4">
<h4 id="org6c86875"><span class="section-number-4">3.16.1</span> <span class="todo TODO">TODO</span> Write a test that pass</h4>
</div>
<div id="outline-container-org9e9dd73" class="outline-4">
<h4 id="org9e9dd73"><span class="section-number-4">3.16.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-16-2">
<p>
Create one method that uses a parameter for the different values.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Employee</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">salary</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">setSalary</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">salary</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">salary</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getSalary</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">raise</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">percent</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span> += <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">salary</span> * (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">percent</span> / 100);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org3e1f870" class="outline-4">
<h4 id="org3e1f870"><span class="section-number-4">3.16.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org9a58e89" class="outline-3">
<h3 id="org9a58e89"><span class="section-number-3">3.17</span> Preserve Whole Object</h3>
<div class="outline-text-3" id="text-3-17">
<p>
Smell: More than one value from an object are passing as parameters in a method call
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">September</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span>;

    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span>, <span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">highestTemp</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span>;
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">lowestTemp</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getHighestTemp</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">highestTemp</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getLowestTemp</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">lowestTemp</span>;
    }
}

<span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Calculator</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateAverageTemperature</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span>, <span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>)
    {
        <span style="color: #ffffff;">return</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span> + <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>) / 2;
    }
}

<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">September</span>(15,5);
<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">calculator</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">Calculator</span>();

<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">averageTemperature</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">calculator</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">calculateAverageTemperature</span>(
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getHighestTemp</span>(),
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getLowestTemp</span>()
        );
</pre>
</div>
</div>
<div id="outline-container-orgc913443" class="outline-4">
<h4 id="orgc913443"><span class="section-number-4">3.17.1</span> Write a test that pass</h4>
<div class="outline-text-4" id="text-3-17-1">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">testCalculateAverageTemperature</span>()
{
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">September</span>(15,5);
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">calculator</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">Calculator</span>();

        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">averageTemperature</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">calculator</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">calculateAverageTemperature</span>(
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getHighestTemp</span>(),
            <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getLowestTemp</span>());

        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">assertEquals</span>(10, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">averageTemperature</span>);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orga6344a2" class="outline-4">
<h4 id="orga6344a2"><span class="section-number-4">3.17.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-17-2">
<p>
Add object as a new parameter. Set it default value to null, that will help to manage the transitions towards the final version of the method.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Calculator</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateAverageTemperature</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span>, <span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>, <span style="color: #7fffd4;">September</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span> = <span style="color: #40e0d0;">null</span>)
    {
        <span style="color: #ffffff;">return</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span> + <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>) / 2;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org7dc2ea5" class="outline-4">
<h4 id="org7dc2ea5"><span class="section-number-4">3.17.3</span> Pass a test</h4>
</div>
<div id="outline-container-org8bc345f" class="outline-4">
<h4 id="org8bc345f"><span class="section-number-4">3.17.4</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-17-4">
<p>
Replace values with values coming from the whole object
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Calculator</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateAverageTemperature</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">highestTemp</span>, <span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">lowestTemp</span>, <span style="color: #7fffd4;">September</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span> = <span style="color: #40e0d0;">null</span>)
    {
        <span style="color: #ffffff;">return</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getHighestTemp</span>() + <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getLowestTemp</span>()) / 2;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfab140c" class="outline-4">
<h4 id="orgfab140c"><span class="section-number-4">3.17.5</span> Pass a test</h4>
</div>
<div id="outline-container-orgc8d13e1" class="outline-4">
<h4 id="orgc8d13e1"><span class="section-number-4">3.17.6</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-17-6">
<p>
Remove useless parameters and default null value of $september object
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Calculator</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">calculateAverageTemperature</span>(<span style="color: #7fffd4;">September</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span>)
    {
        <span style="color: #ffffff;">return</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getHighestTemp</span>() + <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">september</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getLowestTemp</span>()) / 2;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdbd886b" class="outline-4">
<h4 id="orgdbd886b"><span class="section-number-4">3.17.7</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org98e821e" class="outline-3">
<h3 id="org98e821e"><span class="section-number-3">3.18</span> Pull Up Method</h3>
<div class="outline-text-3" id="text-3-18">
<p>
Smell: Subclasses have the same method.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Employee</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">string</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">protected</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    }
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Salesman</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Employee</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getName</span>()
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span>;
    }
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Engineer</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Employee</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getName</span>()
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span>;
    }
}
</pre>
</div>
</div>
<div id="outline-container-org3005bc2" class="outline-4">
<h4 id="org3005bc2"><span class="section-number-4">3.18.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-orgb643baa" class="outline-4">
<h4 id="orgb643baa"><span class="section-number-4">3.18.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-18-2">
<p>
Move the methods to the super class.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Employee</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">string</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">protected</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">name</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getName</span>()
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">name</span>;
    }
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Salesman</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Employee</span> {}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Engineer</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Employee</span> {}
</pre>
</div>
</div>
</div>
<div id="outline-container-org35e963f" class="outline-4">
<h4 id="org35e963f"><span class="section-number-4">3.18.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orgab5aca0" class="outline-3">
<h3 id="orgab5aca0"><span class="section-number-3">3.19</span> Remove Assignments to Parameters</h3>
<div class="outline-text-3" id="text-3-19">
<p>
Smell: Reassign to a parameter
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">discount</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span>): <span style="color: #7fffd4;">int</span>
{
    <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span> &gt; 100) {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span> - 10;
    }
    
    <span style="color: #ffffff;">return</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span>;
}  
</pre>
</div>
</div>
<div id="outline-container-org4a099d6" class="outline-4">
<h4 id="org4a099d6"><span class="section-number-4">3.19.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-orgb52ea44" class="outline-4">
<h4 id="orgb52ea44"><span class="section-number-4">3.19.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-19-2">
<p>
Use a temporary variable instead
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">discount</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span>): <span style="color: #7fffd4;">int</span>
{
    <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">result</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span>;

    <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">priceTotal</span> &gt; 100) {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">result</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">result</span> - 10;
    }

    <span style="color: #ffffff;">return</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">result</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd947f02" class="outline-4">
<h4 id="orgd947f02"><span class="section-number-4">3.19.3</span> Pass a test</h4>
</div>
<div id="outline-container-orgfae7c9d" class="outline-4">
<h4 id="orgfae7c9d"><span class="section-number-4">3.19.4</span> Info</h4>
<div class="outline-text-4" id="text-3-19-4">
<p>
The best practice is that if you pass parameters into a method then they should always represent what were passed in and never be reassigned to mean something else. Btw. in Java you can prevent variable’s reassignment by keyword 'final' before a parameter <a href="https://stackoverflow.com/questions/500508/why-should-i-use-the-keyword-final-on-a-method-parameter-in-java">https://stackoverflow.com/questions/500508/why-should-i-use-the-keyword-final-on-a-method-parameter-in-java</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org8203ddf" class="outline-3">
<h3 id="org8203ddf"><span class="section-number-3">3.20</span> Remove PHPDoc</h3>
<div class="outline-text-3" id="text-3-20">
<p>
Smell: PHPDoc is duplicating type-hint information
Damage: Adds information which not provides additional value
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;"> * </span><span style="color: #40e0d0;">@param</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">int</span><span style="color: #bdb76b;"> </span><span style="color: #9acd32;">$</span><span style="color: #9acd32;">number</span>
<span style="color: #bdb76b;"> * </span><span style="color: #40e0d0;">@return</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">void</span>
<span style="color: #bdb76b;"> */</span>
<span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">setNumber</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>): <span style="color: #7fffd4;">void</span>
{
    <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">number</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">number</span>;
}  
</pre>
</div>
</div>
<div id="outline-container-org0f91c48" class="outline-4">
<h4 id="org0f91c48"><span class="section-number-4">3.20.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org6b933c9" class="outline-4">
<h4 id="org6b933c9"><span class="section-number-4">3.20.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-20-2">
<p>
Remove PHPDoc if it's not provides additional value
</p>
<div class="org-src-container">
<pre class="src src-php">
</pre>
</div>
</div>
</div>
<div id="outline-container-org01b6afb" class="outline-4">
<h4 id="org01b6afb"><span class="section-number-4">3.20.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org0e033da" class="outline-3">
<h3 id="org0e033da"><span class="section-number-3">3.21</span> Rename Function</h3>
<div class="outline-text-3" id="text-3-21">
<p>
Alias: Rename Method, Change Function Declaration
Smell: The name of a method does not reveal it's purpose1
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getInvcdtlmt</span>()
</pre>
</div>
</div>

<div id="outline-container-org989b44b" class="outline-4">
<h4 id="org989b44b"><span class="section-number-4">3.21.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org7ab693d" class="outline-4">
<h4 id="org7ab693d"><span class="section-number-4">3.21.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-21-2">
<p>
Change the name of the method
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getInvoiceableCreditLimit</span>()
</pre>
</div>
</div>
</div>
<div id="outline-container-org79fe6a9" class="outline-4">
<h4 id="org79fe6a9"><span class="section-number-4">3.21.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org004ff4e" class="outline-3">
<h3 id="org004ff4e"><span class="section-number-3">3.22</span> Replace Global with Dependency Injection</h3>
<div class="outline-text-3" id="text-3-22">
<p>
Smell: Variable with 'global' keyword
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Item</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">fetch</span>()
    {
        <span style="color: #ffffff;">global</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">db</span>;
        <span style="color: #ffffff;">return</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">db</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">query</span>(...);
    }
}
</pre>
</div>
</div>

<div id="outline-container-orgd86567f" class="outline-4">
<h4 id="orgd86567f"><span class="section-number-4">3.22.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org808df43" class="outline-4">
<h4 id="org808df43"><span class="section-number-4">3.22.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-22-2">
<p>
Move global variable in class to the constructor
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Item</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #bdb76b;">Database</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">db</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">Database</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">db</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">db</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">db</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">fetch</span>()
    {
        <span style="color: #ffffff;">return</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">db</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">query</span>(...);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb918996" class="outline-4">
<h4 id="orgb918996"><span class="section-number-4">3.22.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org39b67cd" class="outline-3">
<h3 id="org39b67cd"><span class="section-number-3">3.23</span> <span class="done DONE">DONE</span> Replace Magic Number With Symbolic Constant</h3>
<div class="outline-text-3" id="text-3-23">
<p>
Smell: Number with a particular meaning
</p>
<div class="org-src-container">
<pre class="src src-php" id="orgbc2242e"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Circle</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>;
    
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">radius</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>;
    }
    
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getCircumference</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">radius</span> * 2 * 3.1416;
    }
}
</pre>
</div>
</div>
<div id="outline-container-org5213d34" class="outline-4">
<h4 id="org5213d34"><span class="section-number-4">3.23.1</span> Write a test that pass</h4>
<div class="outline-text-4" id="text-3-23-1">
<div class="org-src-container">
<pre class="src src-phpunit" id="orge7b7bbf">
<span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">PHPUnit\Framework\TestCase</span>;

<span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">CircleTest</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">TestCase</span>
{   
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">testGetCircumference</span>()
    {
        <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">circle</span> = <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">Circle</span>(2);
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">assertEquals</span>(12.5664, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">circle</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getCircumference</span>());
    }
}
</pre>
</div>

<pre class="example">
PHPUnit 7.5.2 by Sebastian Bergmann and contributors.

.                                                                   1 / 1 (100%)

Time: 151 ms, Memory: 10.00MB

OK (1 test, 1 assertion)

</pre>
</div>
</div>

<div id="outline-container-org09a3d34" class="outline-4">
<h4 id="org09a3d34"><span class="section-number-4">3.23.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-23-2">
<p>
Create a constant, name it after the meaning, and replace the number with it
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Circle</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #ffffff;">const</span> <span style="color: #40e0d0;">PI</span> = 3.1416;

    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">radius</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">radius</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getCircumference</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">radius</span> * 2 * <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">PI</span>;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb05f65e" class="outline-4">
<h4 id="orgb05f65e"><span class="section-number-4">3.23.3</span> Run a test</h4>
<div class="outline-text-4" id="text-3-23-3">
</div>
</div>
<div id="outline-container-org4b7890f" class="outline-4">
<h4 id="org4b7890f"><span class="section-number-4">3.23.4</span> Helper:</h4>
<div class="outline-text-4" id="text-3-23-4">
<p>
<a href="https://github.com/povils/phpmnd">PHP Magic Number Detector</a> is a tool to detect magic numbers in your PHP code
</p>
</div>
</div>
</div>
<div id="outline-container-orgea73e4f" class="outline-3">
<h3 id="orgea73e4f"><span class="section-number-3">3.24</span> Replace Parameter with Method</h3>
<div class="outline-text-3" id="text-3-24">
<p>
Smell: A method runs different code depending on the values of parameters
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">EmailNotification</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">send</span>(<span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>, <span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">from</span> = <span style="color: #40e0d0;">null</span>)
    {
        <span style="color: #ffffff;">if</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">from</span>){
            <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">mailer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">send</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">from</span>);
        }<span style="color: #ffffff;">else</span>{
            <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">mailer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">send</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>, <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">defaultSender</span>);
        }
    }
}
</pre>
</div>
</div>
<div id="outline-container-org6ce8ba4" class="outline-4">
<h4 id="org6ce8ba4"><span class="section-number-4">3.24.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org8039432" class="outline-4">
<h4 id="org8039432"><span class="section-number-4">3.24.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-24-2">
<p>
Create a separate method for each value of the parameter
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">EmailNotification</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">send</span>(<span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>, <span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">from</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">mailer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">send</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">from</span>);
    }
    
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">sendFromDefaultSender</span>(<span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #7fffd4;">string</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">mailer</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">send</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">to</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">body</span>, <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">defaultSender</span>);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org099ef05" class="outline-4">
<h4 id="org099ef05"><span class="section-number-4">3.24.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orgf3600f4" class="outline-3">
<h3 id="orgf3600f4"><span class="section-number-3">3.25</span> Replace Temp with Query</h3>
<div class="outline-text-3" id="text-3-25">
<p>
Smell: Using a temporary variable to hold the result of an expression.
Damage: Temporary variable increase the temptation to write longer methods. Temporaries aren’t necessarily bad, but sometimes they attract new code.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getTotalPrice</span>(): <span style="color: #7fffd4;">int</span>
{
    <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">basePrice</span> = <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">quantity</span> * <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">itemPrice</span>;

    <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">basePrice</span> &gt; <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">DISCOUNT_POINT</span>) {
        <span style="color: #ffffff;">return</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">basePrice</span> * <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">DISCOUNT</span>;
    }
    <span style="color: #ffffff;">return</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">basePrice</span>;
}
</pre>
</div>
</div>
<div id="outline-container-org1dca37b" class="outline-4">
<h4 id="org1dca37b"><span class="section-number-4">3.25.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org8ebf533" class="outline-4">
<h4 id="org8ebf533"><span class="section-number-4">3.25.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-25-2">
<p>
Extract the expression into a method. Replace all references to the temp with the expression. The new method can then be used in other methods.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getTotalPrice</span>(): <span style="color: #7fffd4;">int</span>
{
    <span style="color: #ffffff;">if</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getBasePrice</span>() &gt; <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">DISCOUNT_POINT</span>) {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getBasePrice</span>() * <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">DISCOUNT</span>;
    }
    <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #f5deb3; background-color: #000000;">getBasePrice</span>();
}

<span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getBasePrice</span>(): <span style="color: #7fffd4;">int</span>
{
    <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">quantity</span> * <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">itemPrice</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcba72e0" class="outline-4">
<h4 id="orgcba72e0"><span class="section-number-4">3.25.3</span> Pass a test</h4>
</div>
<div id="outline-container-org1db8a64" class="outline-4">
<h4 id="org1db8a64"><span class="section-number-4">3.25.4</span> Info</h4>
<div class="outline-text-4" id="text-3-25-4">
<p>
Now, but wait, you might say. Isn't this more inefficient? Because if we created the temp the old way, we'd only have to execute the expression once, but if we turn it into a method, we might be calling it many different times. And yes, you're absolutely right, but remember, the pure efficiency of the code is not our first goal in refactoring. Clarity is. The likelihood is that a typical expression you would deal with in this sort of refactoring is going to be so undemanding, it wouldn't be noticeable at all, even having to call it several more times. But if it is an intensive operation, an intensive expression, well you should really be working on that later, after you've refactored using profilers. And other tools to make sure you're not doing pointless, premature optimization. And the real benefit is that by creating this as its own method, we will also have use of it anywhere else in the class, which wasn't the case before. As the original temp was scoped to the original method. So, we won't be tempted to add more code to the original method just to have access to that temp.
</p>
</div>
</div>
</div>
<div id="outline-container-orge41672f" class="outline-3">
<h3 id="orge41672f"><span class="section-number-3">3.26</span> Replacing Type Code with Subclasses</h3>
<div class="outline-text-3" id="text-3-26">
<p>
Smell: Immutable type code affecting the class behavior.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">int</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">accountType</span>;

    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">balance</span>;

    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">int</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">const</span> <span style="color: #40e0d0;">CHECKING</span> = 0;

    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">int</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">const</span> <span style="color: #40e0d0;">SAVINGS</span> = 1;

    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">int</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">const</span> <span style="color: #40e0d0;">INVESTMENT</span> = 2;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">__construct</span>(<span style="color: #7fffd4;">int</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">accountType</span>)
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">accountType</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">accountType</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getAccountType</span>(): <span style="color: #7fffd4;">int</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">accountType</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getBalance</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdraw</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">void</span>
    {
        <span style="color: #ffffff;">switch</span> (<span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">accountType</span>){
            <span style="color: #ffffff;">case</span> <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">CHECKING</span>:
                <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>;
                <span style="color: #ffffff;">break</span>;
            <span style="color: #ffffff;">case</span> <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">SAVINGS</span>:
                <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span> + 100;
                <span style="color: #ffffff;">break</span>;
            <span style="color: #ffffff;">case</span> <span style="color: #ffffff;">self</span><span style="color: #f5deb3; background-color: #000000;">::</span><span style="color: #40e0d0;">INVESTMENT</span>:
                <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span> + 300;
                <span style="color: #ffffff;">break</span>;
            <span style="color: #ffffff;">default</span>:
                <span style="color: #ffffff;">throw</span> <span style="color: #ffffff;">new</span> <span style="color: #7fffd4;">RuntimeException</span>(<span style="color: #bdb76b;">'Unknown Account Type'</span>);
        }
    }
}
</pre>
</div>
</div>
<div id="outline-container-orga11dad3" class="outline-4">
<h4 id="orga11dad3"><span class="section-number-4">3.26.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-orgaaf88a0" class="outline-4">
<h4 id="orgaaf88a0"><span class="section-number-4">3.26.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-26-2">
<p>
Replace the type code with subclasses.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">abstract</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">balance</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getBalance</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span>;
    }
    
    <span style="color: #ffffff;">abstract</span> <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdraw</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">void</span>
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">AccountChecking</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdraw</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">void</span>
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>;
    }
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">AccountSavings</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdraw</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">void</span>
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span> + 100;
    }
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">AccountInvestment</span> <span style="color: #ffffff;">extends</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdraw</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">void</span>
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span> + 300;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org01455bc" class="outline-4">
<h4 id="org01455bc"><span class="section-number-4">3.26.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-org271382f" class="outline-3">
<h3 id="org271382f"><span class="section-number-3">3.27</span> Separate Query from Modifier</h3>
<div class="outline-text-3" id="text-3-27">
<p>
Smell: A method that returns a value but also changes the state of an object.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">balance</span>;
    
    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdrawAndGetBalance</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>;
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span>;
    }
}
</pre>
</div>
</div>
<div id="outline-container-orgae5c320" class="outline-4">
<h4 id="orgae5c320"><span class="section-number-4">3.27.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org30876f1" class="outline-4">
<h4 id="org30876f1"><span class="section-number-4">3.27.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-27-2">
<p>
Create two methods, one for the query and one for the modification.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">Account</span>
{
    <span style="color: #bdb76b;">/**</span>
<span style="color: #bdb76b;">     * </span><span style="color: #40e0d0;">@var</span><span style="color: #bdb76b;"> </span><span style="color: #7fffd4;">float</span>
<span style="color: #bdb76b;">     */</span>
    <span style="color: #ffffff;">private</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">balance</span>;

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">getBalance</span>(): <span style="color: #7fffd4;">float</span>
    {
        <span style="color: #ffffff;">return</span> <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span>;
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">withdraw</span>(<span style="color: #7fffd4;">float</span> <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>): <span style="color: #7fffd4;">void</span>
    {
        <span style="color: #40e0d0;">$</span><span style="color: #40e0d0;">this</span><span style="color: #f5deb3; background-color: #000000;">-&gt;</span><span style="color: #9acd32;">balance</span> -= <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">amount</span>;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org035405b" class="outline-4">
<h4 id="org035405b"><span class="section-number-4">3.27.3</span> Pass a test</h4>
</div>
</div>
<div id="outline-container-orgc9939b6" class="outline-3">
<h3 id="orgc9939b6"><span class="section-number-3">3.28</span> Split Temporary Variable</h3>
<div class="outline-text-3" id="text-3-28">
<p>
Smell: Temporary variable is assigned to more than once (overwrite), but is not a loop variable nor a collecting temporary variable.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">temp</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">item</span>.getPrice() * item.getQuantity();
<span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Total: </span><span style="color: #9acd32;">$temp</span><span style="color: #bdb76b;">"</span>;
<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">temp</span> = order.getTotal() - order.getDiscount();
<span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Price after discount: </span><span style="color: #9acd32;">$temp</span><span style="color: #bdb76b;">;"</span>
</pre>
</div>
</div>
<div id="outline-container-orgce8002f" class="outline-4">
<h4 id="orgce8002f"><span class="section-number-4">3.28.1</span> Write a test that pass</h4>
</div>
<div id="outline-container-org972d0c8" class="outline-4">
<h4 id="org972d0c8"><span class="section-number-4">3.28.2</span> Refactor the code</h4>
<div class="outline-text-4" id="text-3-28-2">
<p>
Make a separate temporary variable for each assignment.
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">totalPrice</span> = <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">item</span>.getPrice() * item.getQuantity();
<span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Total: </span><span style="color: #9acd32;">$totalPrice</span><span style="color: #bdb76b;">"</span>;
<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">totalDiscountPrice</span> = order.getTotal() - order.getDiscount();
<span style="color: #ffffff;">echo</span> <span style="color: #bdb76b;">"Price after discount: </span><span style="color: #9acd32;">$totalDiscountPrice</span><span style="color: #bdb76b;">"</span>;
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbab978d" class="outline-4">
<h4 id="orgbab978d"><span class="section-number-4">3.28.3</span> Pass a test</h4>
</div>
</div>
</div>
<div id="outline-container-org87bbc61" class="outline-2">
<h2 id="org87bbc61"><span class="section-number-2">4</span> Database</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org5861a72" class="outline-3">
<h3 id="org5861a72"><span class="section-number-3">4.1</span> Refactorings</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org1aec46f" class="outline-4">
<h4 id="org1aec46f"><span class="section-number-4">4.1.1</span> Add CRUD Methods</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
Introduce stored procedures (methods) to implement the creation,
retrieval, update, and deletion (CRUD) of the data representing a business entity.
</p>
</div>
</div>
<div id="outline-container-org429d080" class="outline-4">
<h4 id="org429d080"><span class="section-number-4">4.1.2</span> Add Foreign Key Constraint</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
Add a foreign key constraint to an existing table to enforce
a relationship to another table.
</p>
</div>
</div>
<div id="outline-container-org47ff763" class="outline-4">
<h4 id="org47ff763"><span class="section-number-4">4.1.3</span> Add Lookup Table</h4>
<div class="outline-text-4" id="text-4-1-3">
<p>
Create a lookup table for an existing column.
</p>
</div>
</div>
<div id="outline-container-orgca79617" class="outline-4">
<h4 id="orgca79617"><span class="section-number-4">4.1.4</span> Add Mirror Table</h4>
<div class="outline-text-4" id="text-4-1-4">
<p>
Create a mirror table, an exact duplicate of an existing table in one
database, in another database.
</p>
</div>
</div>
<div id="outline-container-org30d9ef2" class="outline-4">
<h4 id="org30d9ef2"><span class="section-number-4">4.1.5</span> Add Parameter</h4>
<div class="outline-text-4" id="text-4-1-5">
<p>
Existing method needs information that was not passed in before.
</p>
</div>
</div>
<div id="outline-container-orgae30c86" class="outline-4">
<h4 id="orgae30c86"><span class="section-number-4">4.1.6</span> Add Read Method</h4>
<div class="outline-text-4" id="text-4-1-6">
<p>
Introduce a methodin this case, a stored procedureto implement the
retrieval of the data representing zero or more business entities from the database.
</p>
</div>
</div>
<div id="outline-container-org372b99a" class="outline-4">
<h4 id="org372b99a"><span class="section-number-4">4.1.7</span> Add Trigger For Calculated Column</h4>
<div class="outline-text-4" id="text-4-1-7">
<p>
Introduce a new trigger to update the value
contained in a calculated column.
</p>
</div>
</div>
<div id="outline-container-org4a20903" class="outline-4">
<h4 id="org4a20903"><span class="section-number-4">4.1.8</span> Apply Standard Codes</h4>
<div class="outline-text-4" id="text-4-1-8">
<p>
Apply a standard set of code values to a single column to ensure
that it conforms to the values of similar columns stored elsewhere in the database.
</p>
</div>
</div>
<div id="outline-container-org088cbad" class="outline-4">
<h4 id="org088cbad"><span class="section-number-4">4.1.9</span> Apply Standard Type</h4>
<div class="outline-text-4" id="text-4-1-9">
<p>
Ensure that the data type of a column is consistent with the data
type of other similar columns within the database.
</p>
</div>
</div>
<div id="outline-container-org7f37c80" class="outline-4">
<h4 id="org7f37c80"><span class="section-number-4">4.1.10</span> Consolidate Conditional Expression</h4>
<div class="outline-text-4" id="text-4-1-10">
<p>
Combine sequence of conditional tests into a
single conditional expression and extract it.
</p>
</div>
</div>
<div id="outline-container-org9f13777" class="outline-4">
<h4 id="org9f13777"><span class="section-number-4">4.1.11</span> Consolidate Key Strategy</h4>
<div class="outline-text-4" id="text-4-1-11">
<p>
Choose a single key strategy for an entity and apply it
consistently throughout your database.
</p>
</div>
</div>
<div id="outline-container-org44db7c6" class="outline-4">
<h4 id="org44db7c6"><span class="section-number-4">4.1.12</span> Decompose Conditional</h4>
<div class="outline-text-4" id="text-4-1-12">
<p>
Extract methods from the condition.
</p>
</div>
</div>
<div id="outline-container-org3097027" class="outline-4">
<h4 id="org3097027"><span class="section-number-4">4.1.13</span> Drop Column</h4>
<div class="outline-text-4" id="text-4-1-13">
<p>
Remove a column from an existing table.
</p>
</div>
</div>
<div id="outline-container-org25277fa" class="outline-4">
<h4 id="org25277fa"><span class="section-number-4">4.1.14</span> Drop Column Constraint</h4>
<div class="outline-text-4" id="text-4-1-14">
<p>
Remove a column constraint from an existing table.
</p>
</div>
</div>
<div id="outline-container-orgfc1ca48" class="outline-4">
<h4 id="orgfc1ca48"><span class="section-number-4">4.1.15</span> Drop Default Value</h4>
<div class="outline-text-4" id="text-4-1-15">
<p>
Remove the default value that is provided by a database from an
existing table column.
</p>
</div>
</div>
<div id="outline-container-orgbe39040" class="outline-4">
<h4 id="orgbe39040"><span class="section-number-4">4.1.16</span> Drop Foreign Key Constraint</h4>
<div class="outline-text-4" id="text-4-1-16">
<p>
Remove a foreign key constraint from an existing table so
that a relationship to another table is no longer enforced by the database.
</p>
</div>
</div>
<div id="outline-container-org46e0180" class="outline-4">
<h4 id="org46e0180"><span class="section-number-4">4.1.17</span> Drop Non-Nullable</h4>
<div class="outline-text-4" id="text-4-1-17">
<p>
Change an existing non-nullable column so that it accepts null
values.
</p>
</div>
</div>
<div id="outline-container-org6fc0f9f" class="outline-4">
<h4 id="org6fc0f9f"><span class="section-number-4">4.1.18</span> Drop Table</h4>
<div class="outline-text-4" id="text-4-1-18">
<p>
Remove an existing table from the database.
</p>
</div>
</div>
<div id="outline-container-org921b28f" class="outline-4">
<h4 id="org921b28f"><span class="section-number-4">4.1.19</span> Drop View</h4>
<div class="outline-text-4" id="text-4-1-19">
<p>
Remove an existing view.
</p>
</div>
</div>
<div id="outline-container-orgf5f9ff0" class="outline-4">
<h4 id="orgf5f9ff0"><span class="section-number-4">4.1.20</span> Encapsulate Table With View</h4>
<div class="outline-text-4" id="text-4-1-20">
<p>
Wrap access to an existing table with a view.
</p>
</div>
</div>
<div id="outline-container-orgeee4dc4" class="outline-4">
<h4 id="orgeee4dc4"><span class="section-number-4">4.1.21</span> Extract Method</h4>
<div class="outline-text-4" id="text-4-1-21">
<p>
Turn the code fragment into a method whose name explains the
purpose of the method.Insert Data (page 296): Insert data into an existing table.
</p>
</div>
</div>
<div id="outline-container-org826aa99" class="outline-4">
<h4 id="org826aa99"><span class="section-number-4">4.1.22</span> Introduce Calculated Column</h4>
<div class="outline-text-4" id="text-4-1-22">
<p>
Introduce a new column based on calculations involving
data in one or more tables.
</p>
</div>
</div>
<div id="outline-container-org9703a39" class="outline-4">
<h4 id="org9703a39"><span class="section-number-4">4.1.23</span> Introduce Calculation Method</h4>
<div class="outline-text-4" id="text-4-1-23">
<p>
Introduce a new method, typically a stored function,
which implements a calculation that uses data stored within the database.
</p>
</div>
</div>
<div id="outline-container-org4568240" class="outline-4">
<h4 id="org4568240"><span class="section-number-4">4.1.24</span> Introduce Cascading Delete</h4>
<div class="outline-text-4" id="text-4-1-24">
<p>
Ensure that the database automatically deletes the
appropriate "child records" when a "parent record" is deleted.
</p>
</div>
</div>
<div id="outline-container-org29bb766" class="outline-4">
<h4 id="org29bb766"><span class="section-number-4">4.1.25</span> Introduce Column Constraint</h4>
<div class="outline-text-4" id="text-4-1-25">
<p>
Introduce a column constraint in an existing table.
</p>
</div>
</div>
<div id="outline-container-org4653a79" class="outline-4">
<h4 id="org4653a79"><span class="section-number-4">4.1.26</span> Introduce Common Format</h4>
<div class="outline-text-4" id="text-4-1-26">
<p>
Apply a consistent format to all the data values in an
existing table column.
</p>
</div>
</div>
<div id="outline-container-orge01e660" class="outline-4">
<h4 id="orge01e660"><span class="section-number-4">4.1.27</span> Introduce Default Value</h4>
<div class="outline-text-4" id="text-4-1-27">
<p>
Let the database provide a default value for an existing table
column.
</p>
</div>
</div>
<div id="outline-container-orga8d054b" class="outline-4">
<h4 id="orga8d054b"><span class="section-number-4">4.1.28</span> Introduce Hard Delete</h4>
<div class="outline-text-4" id="text-4-1-28">
<p>
Remove an existing column which indicates that a row has been
deleted and instead actually delete the row.
</p>
</div>
</div>
<div id="outline-container-org616a308" class="outline-4">
<h4 id="org616a308"><span class="section-number-4">4.1.29</span> Introduce Index</h4>
<div class="outline-text-4" id="text-4-1-29">
<p>
Introduce a new index of either unique or non-unique type.
</p>
</div>
</div>
<div id="outline-container-org4b951c7" class="outline-4">
<h4 id="org4b951c7"><span class="section-number-4">4.1.30</span> Introduce New Column</h4>
<div class="outline-text-4" id="text-4-1-30">
<p>
Introduce a new column in an existing table.
</p>
</div>
</div>
<div id="outline-container-org567770b" class="outline-4">
<h4 id="org567770b"><span class="section-number-4">4.1.31</span> Introduce New Table</h4>
<div class="outline-text-4" id="text-4-1-31">
<p>
Introduce a new table in an existing database.
</p>
</div>
</div>
<div id="outline-container-org71e29dd" class="outline-4">
<h4 id="org71e29dd"><span class="section-number-4">4.1.32</span> Introduce Read-Only Table</h4>
<div class="outline-text-4" id="text-4-1-32">
<p>
Create a read-only data store based on existing tables in
the database.
</p>
</div>
</div>
<div id="outline-container-org237fa32" class="outline-4">
<h4 id="org237fa32"><span class="section-number-4">4.1.33</span> Introduce Soft Delete</h4>
<div class="outline-text-4" id="text-4-1-33">
<p>
Introduce a flag to an existing table which indicates that a row
has been deleted instead of actually deleting the row.
</p>
</div>
<ol class="org-ol">
<li><a id="org5f161c6"></a>Motivation<br />
<div class="outline-text-5" id="text-4-1-33-1">
<p>
preserve all application data, typically for historical means.
</p>
</div>
</li>
<li><a id="org3110bd4"></a>Tradeoffs<br />
<ol class="org-ol">
<li><a id="orga95c52a"></a>more data - table have to store valid rows and those mark as deleted<br /></li>
<li><a id="orgdb19dc4"></a>performace - more data means reduction in query performace - the additional work of distinguishing between deleted and nondeleted rows<br /></li>
<li><a id="org367be4f"></a>code complexity<br />
<ol class="org-ol">
<li><a id="org1f8c789"></a>mostly in every query we would have to remember add 'where isDeleted = false'<br /></li>
<li><a id="org3246788"></a>You may have associations going from Table A to Table B and when you soft delete something from Table A, you need to ensure that independent queries on Table B take care of that fact.<br /></li>
</ol>
</li>
</ol>
</li>
<li><a id="org1be7edb"></a>How<br />
<ol class="org-ol">
<li><a id="org14b1321"></a>Introduce New Column<br />
<ol class="org-ol">
<li><a id="org7bb5cd2"></a>isDeleted<br />
<ol class="org-ol">
<li><a id="orgcccdb4c"></a>bool not null false<br /></li>
<li><a id="orga851a5b"></a>date/timestamp null<br /></li>
</ol>
</li>
</ol>
</li>
<li><a id="org2f73f1a"></a>Update<br />
<ol class="org-ol">
<li><a id="org38fbd73"></a>application<br /></li>
<li><a id="org44511c6"></a>database trigger - it is simple and it avoids the risk that the applications will not update the column properly<br /></li>
</ol>
</li>
</ol>
</li>
<li><a id="org6b6b5f5"></a>Opposite<br />
<div class="outline-text-5" id="text-4-1-33-4">
<p>
Introduce Hard Delete
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgc0d67a5" class="outline-4">
<h4 id="orgc0d67a5"><span class="section-number-4">4.1.34</span> Introduce Surrogate Key</h4>
<div class="outline-text-4" id="text-4-1-34">
<p>
Replace an existing natural key with a surrogate key.
</p>
</div>
</div>
<div id="outline-container-orgaeda5e4" class="outline-4">
<h4 id="orgaeda5e4"><span class="section-number-4">4.1.35</span> Introduce Trigger For History</h4>
<div class="outline-text-4" id="text-4-1-35">
<p>
Introduce a new trigger to capture data changes for historical purposes.
</p>
</div>
<ol class="org-ol">
<li><a id="org4059e53"></a>Motivation<br />
<div class="outline-text-5" id="text-4-1-35-1">
<p>
delegate the tracking of data changes to the database itself
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgf020839" class="outline-4">
<h4 id="orgf020839"><span class="section-number-4">4.1.36</span> Introduce Variable</h4>
<div class="outline-text-4" id="text-4-1-36">
<p>
Put the result of the expression, or parts of the expression, in a
temporary variable with a name that explains the purpose.
</p>
</div>
</div>
<div id="outline-container-orga54b4d7" class="outline-4">
<h4 id="orga54b4d7"><span class="section-number-4">4.1.37</span> Introduce View</h4>
<div class="outline-text-4" id="text-4-1-37">
<p>
Create a view based on existing tables in the database.
</p>
</div>
<ol class="org-ol">
<li><a id="org1342653"></a>Motivation<br />
<ol class="org-ol">
<li><a id="org3fdcb48"></a>Summarize data for reporting. Many reports require summary data, which can be generated via the view definition.<br /></li>
<li><a id="org9d9970e"></a>Replace redundant reads. Several external programs, or stored procedures for that matter, often implement the same retrieval query. These queries can be replaced by a common readonly table or view.<br /></li>
<li><a id="orgb9f6829"></a>Data security. A view can be used to provide end users with read access to data but not update privileges.<br /></li>
<li><a id="org251e649"></a>Encapsulate access to a table. Some organizations choose to encapsulate access to tables by defining updateable views that external programs access instead of the source tables. This enables the organization to easily perform database refactorings such as Rename Column (page 109) or Rename Table (page 113) without impacting the external applications, because views add an encapsulation layer between your tables and your application.<br /></li>
<li><a id="org9624868"></a>Reduce SQL duplication. When you have complex SQL queries in an application, it is common to discover that parts of the SQL are duplicated in many places. When this is the case, you should introduce views to extract out the duplicate SQL, as shown in the example section.<br /></li>
</ol>
</li>

<li><a id="org4d974e6"></a>Tradeoffs<br />
<ol class="org-ol">
<li><a id="org6d46332"></a>poor performance of the joins<br /></li>
<li><a id="orgf706147"></a>increases the coupling with database schemas<br /></li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-orgd06ed35" class="outline-4">
<h4 id="orgd06ed35"><span class="section-number-4">4.1.38</span> Make Column Non-Nullable</h4>
<div class="outline-text-4" id="text-4-1-38">
<p>
Change an existing column so that it does not accept any
null values.
</p>
</div>
</div>
<div id="outline-container-orgeaa561e" class="outline-4">
<h4 id="orgeaa561e"><span class="section-number-4">4.1.39</span> Merge Columns</h4>
<div class="outline-text-4" id="text-4-1-39">
<p>
Merge two or more columns within a single table.
</p>
</div>
</div>
<div id="outline-container-orgf4add75" class="outline-4">
<h4 id="orgf4add75"><span class="section-number-4">4.1.40</span> Merge Tables</h4>
<div class="outline-text-4" id="text-4-1-40">
<p>
Merge two or more tables into a single table.
</p>
</div>
</div>
<div id="outline-container-orge9f248d" class="outline-4">
<h4 id="orge9f248d"><span class="section-number-4">4.1.41</span> Migrate Method From Database</h4>
<div class="outline-text-4" id="text-4-1-41">
<p>
Rehost an existing database method (a stored
procedure, stored function, or trigger) in the application(s) which currently invoke it.
</p>
</div>
</div>
<div id="outline-container-org9f17f34" class="outline-4">
<h4 id="org9f17f34"><span class="section-number-4">4.1.42</span> Migrate Method To Database</h4>
<div class="outline-text-4" id="text-4-1-42">
<p>
Rehost existing application logic in the database.
</p>
</div>
</div>
<div id="outline-container-orgcffc1a4" class="outline-4">
<h4 id="orgcffc1a4"><span class="section-number-4">4.1.43</span> Move Column</h4>
<div class="outline-text-4" id="text-4-1-43">
<p>
Migrate a table column, with all of its data, to another existing table.
</p>
</div>
</div>
<div id="outline-container-orgc9c5dc6" class="outline-4">
<h4 id="orgc9c5dc6"><span class="section-number-4">4.1.44</span> Move Data</h4>
<div class="outline-text-4" id="text-4-1-44">
<p>
Move the data contained within a table, either all or a subset of its columns,
to another existing table.
</p>
</div>
</div>
<div id="outline-container-org1034ba9" class="outline-4">
<h4 id="org1034ba9"><span class="section-number-4">4.1.45</span> Parameterize Method</h4>
<div class="outline-text-4" id="text-4-1-45">
<p>
Create one method that uses a parameter for the different
values.
</p>
</div>
</div>
<div id="outline-container-org7057928" class="outline-4">
<h4 id="org7057928"><span class="section-number-4">4.1.46</span> Remove Control Flag</h4>
<div class="outline-text-4" id="text-4-1-46">
<p>
Use return or break instead of a variable acting as a control flag.
</p>
</div>
</div>
<div id="outline-container-org31f5e20" class="outline-4">
<h4 id="org31f5e20"><span class="section-number-4">4.1.47</span> Remove Middle Man</h4>
<div class="outline-text-4" id="text-4-1-47">
<p>
Get the caller to call the method directly.
</p>
</div>
</div>
<div id="outline-container-org4229ec8" class="outline-4">
<h4 id="org4229ec8"><span class="section-number-4">4.1.48</span> Remove Parameter</h4>
<div class="outline-text-4" id="text-4-1-48">
<p>
Remove a parameter no longer used by the method body.
</p>
</div>
</div>
<div id="outline-container-org94d25db" class="outline-4">
<h4 id="org94d25db"><span class="section-number-4">4.1.49</span> Rename Column</h4>
<div class="outline-text-4" id="text-4-1-49">
<p>
Rename an existing table column with a name that explains its purpose.
</p>
</div>
</div>
<div id="outline-container-orgd7c0a5f" class="outline-4">
<h4 id="orgd7c0a5f"><span class="section-number-4">4.1.50</span> Rename Method</h4>
<div class="outline-text-4" id="text-4-1-50">
<p>
Rename an existing method with a name that explains its purpose.
</p>
</div>
</div>
<div id="outline-container-org67d67ea" class="outline-4">
<h4 id="org67d67ea"><span class="section-number-4">4.1.51</span> Rename Table</h4>
<div class="outline-text-4" id="text-4-1-51">
<p>
Rename an existing table with a name that explains its purpose.
</p>
</div>
</div>
<div id="outline-container-orgde3b182" class="outline-4">
<h4 id="orgde3b182"><span class="section-number-4">4.1.52</span> Rename View</h4>
<div class="outline-text-4" id="text-4-1-52">
<p>
Rename an existing view with a name that explains its purpose.
</p>
</div>
</div>
<div id="outline-container-orga005565" class="outline-4">
<h4 id="orga005565"><span class="section-number-4">4.1.53</span> Reorder Parameters</h4>
<div class="outline-text-4" id="text-4-1-53">
<p>
Change the order of the parameters of a method.
</p>
</div>
</div>
<div id="outline-container-orgc8bc0d4" class="outline-4">
<h4 id="orgc8bc0d4"><span class="section-number-4">4.1.54</span> Replace Column</h4>
<div class="outline-text-4" id="text-4-1-54">
<p>
Replace an existing non-key column with a new one.
</p>
</div>
</div>
<div id="outline-container-orgfe30bcd" class="outline-4">
<h4 id="orgfe30bcd"><span class="section-number-4">4.1.55</span> Replace LOB With Table</h4>
<div class="outline-text-4" id="text-4-1-55">
<p>
Replace a large object (LOB) column that contains structured data with a new table or in the same table.
</p>
</div>
</div>
<div id="outline-container-orgb50e6f9" class="outline-4">
<h4 id="orgb50e6f9"><span class="section-number-4">4.1.56</span> Replace Literal With Table Lookup</h4>
<div class="outline-text-4" id="text-4-1-56">
<p>
Replace code constants with values from database tables.
</p>
</div>
</div>
<div id="outline-container-org52e158f" class="outline-4">
<h4 id="org52e158f"><span class="section-number-4">4.1.57</span> Replace Method(s) With View</h4>
<div class="outline-text-4" id="text-4-1-57">
<p>
Create a view based on one or more existing database
methods (stored procedures, stored functions, or triggers) within the database.
</p>
</div>
</div>
<div id="outline-container-orgd75485c" class="outline-4">
<h4 id="orgd75485c"><span class="section-number-4">4.1.58</span> Replace Nested Conditional With Guard Clauses</h4>
<div class="outline-text-4" id="text-4-1-58">
<p>
Remove nested if conditions with a series of separate IF statements.
</p>
</div>
</div>
<div id="outline-container-org4bfd9da" class="outline-4">
<h4 id="org4bfd9da"><span class="section-number-4">4.1.59</span> Replace One-To-Many With Associative Table</h4>
<div class="outline-text-4" id="text-4-1-59">
<p>
Replace a one-to-many association between two tables with an associative table.
</p>
</div>
</div>
<div id="outline-container-org5e601cb" class="outline-4">
<h4 id="org5e601cb"><span class="section-number-4">4.1.60</span> Replace Parameter With Explicit Methods</h4>
<div class="outline-text-4" id="text-4-1-60">
<p>
Create a separate method for each value of the parameter.
</p>
</div>
</div>
<div id="outline-container-orgfeea758" class="outline-4">
<h4 id="orgfeea758"><span class="section-number-4">4.1.61</span> Replace Surrogate Key With Natural Key</h4>
<div class="outline-text-4" id="text-4-1-61">
<p>
Replace a surrogate key with an existing natural key.
</p>
</div>
</div>
<div id="outline-container-orgcce90d6" class="outline-4">
<h4 id="orgcce90d6"><span class="section-number-4">4.1.62</span> Replace Type Code With Property Flags</h4>
<div class="outline-text-4" id="text-4-1-62">
<p>
Replace a code column with individual property flags, usually implemented as Boolean columns, within the same table column.
</p>
</div>
</div>
<div id="outline-container-org0f2a9f3" class="outline-4">
<h4 id="org0f2a9f3"><span class="section-number-4">4.1.63</span> Replace View With Method(s)</h4>
<div class="outline-text-4" id="text-4-1-63">
<p>
Replace an existing view with one or more existing
methods (stored procedures, stored functions, or triggers) within the database.
</p>
</div>
</div>
<div id="outline-container-org6e41ecb" class="outline-4">
<h4 id="org6e41ecb"><span class="section-number-4">4.1.64</span> Split Column</h4>
<div class="outline-text-4" id="text-4-1-64">
<p>
Split a column into one or more columns within a single table.
</p>
</div>
</div>
<div id="outline-container-orga7fdb2d" class="outline-4">
<h4 id="orga7fdb2d"><span class="section-number-4">4.1.65</span> Split Table</h4>
<div class="outline-text-4" id="text-4-1-65">
<p>
Vertically split (e.g., by columns) an existing table into one or more tables.
</p>
</div>
</div>
<div id="outline-container-org6cc730e" class="outline-4">
<h4 id="org6cc730e"><span class="section-number-4">4.1.66</span> Split Temporary Variable</h4>
<div class="outline-text-4" id="text-4-1-66">
<p>
Make a separate temporary variable for each assignment.
</p>
</div>
</div>
<div id="outline-container-orgb2d6a6b" class="outline-4">
<h4 id="orgb2d6a6b"><span class="section-number-4">4.1.67</span> Substitute Algorithm</h4>
<div class="outline-text-4" id="text-4-1-67">
<p>
Replace the body of the method with the new algorithm.
</p>
</div>
</div>
<div id="outline-container-org1cdf2de" class="outline-4">
<h4 id="org1cdf2de"><span class="section-number-4">4.1.68</span> Update Data</h4>
<div class="outline-text-4" id="text-4-1-68">
<p>
Update data within an existing table.
</p>
</div>
</div>
<div id="outline-container-org78c9b5c" class="outline-4">
<h4 id="org78c9b5c"><span class="section-number-4">4.1.69</span> Use Official Data Source</h4>
<div class="outline-text-4" id="text-4-1-69">
<p>
Use the official data source for a given entity, instead of the
current one you are using.
</p>
</div>
</div>
</div>
<div id="outline-container-orga8ea414" class="outline-3">
<h3 id="orga8ea414"><span class="section-number-3">4.2</span> Links</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li><a href="https://use-the-index-luke.com/">https://use-the-index-luke.com/</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc7c3700" class="outline-2">
<h2 id="orgc7c3700"><span class="section-number-2">5</span> <span class="todo TODO">TODO</span> Smells</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org854345d" class="outline-3">
<h3 id="org854345d"><span class="section-number-3">5.1</span> Booch’s fundamental design principles</h3>
<div class="outline-text-3" id="text-5-1">
</div>
<div id="outline-container-org78c5b91" class="outline-4">
<h4 id="org78c5b91"><span class="section-number-4">5.1.1</span> abstraction</h4>
<div class="outline-text-4" id="text-5-1-1">
</div>
<ol class="org-ol">
<li><a id="org97fe830"></a>Missing Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-1">
<p>
Clumps of data or encoded strings are used instead of creating a class or an interface
</p>

<p>
PROBLEMS:
</p>
<ul class="org-ul">
<li>it can expose implementation details to different abstractions, violating the principle of encapsulation.</li>
<li>When data and associated behavior are spread across abstractions, it can</li>
</ul>
<p>
lead to tight coupling between entities, resulting in brittle and non-reusable
code. Hence, not creating necessary abstractions also violates the principle of
modularization.
</p>

<p>
POTENTIAL CAUSES:
</p>

<p>
Inadequate design analysis
When careful thought is not applied during design, it is easy to overlook creating
abstractions and use primitive type values or strings to “get the work done.” In our
experience, this often occurs when software is developed under tight deadlines or
resource constraints.
</p>

<p>
Lack of refactoring
As requirements change, software evolves and entities that were earlier represented
using strings or primitive types may need to be refactored into classes or interfaces.
When the existing clumps of data or encoded strings are retained as they are without
refactoring them, it can lead to a Missing Abstraction smell.
</p>

<p>
Misguided focus on minor performance gains
This smell often results when designers compromise design quality for minor performance gains.
For instance, we have observed developers using arrays directly in the code
instead of creating appropriate abstractions since they feel that indexing arrays is faster
than accessing members in objects. In most contexts, the performance gains due to such
“optimizations” are minimal, and do not justify the resultant trade-off in design quality.
</p>

<p>
<a href="https://steemit.com/php/@crell/php-use-associative-arrays-basically-never">https://steemit.com/php/@crell/php-use-associative-arrays-basically-never</a>
</p>

<p>
REFACTOR - The refactoring for this smell is to create abstraction(s) that can internally make use
of primitive type values or strings. For example, if a primitive type value is used as a
“type-code,” then apply “replace type-code with class”.
</p>

<p>
ALIAS:
Primitive Obsession — This smell occurs when primitive types are used for
encoding dates, currency, etc. instead of creating classes.
</p>

<p>
Data clumps — This smell occurs when there are clumps of data items that
occur together in lots of places instead of creating a class.
</p>
</div>
</li>
<li><a id="orgfed069a"></a>Imperative Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-2">
<p>
Consider the case of a large-sized financial application. This application employs
	   classes named CreateReport, CopyReport, DisplayReport, etc. to deal with its report
	   generation functionality. Each class has exactly one method definition named create,
	   copy, display, etc., respectively, and suffers from Imperative Abstraction smell. The
	   data items relating to a report such as name of the report, data elements that need to be
	   displayed in the report, kind of report, etc. are housed in a “data class” named Report.
	   The smell not only increases the number of classes (in this case there are at least
	   four classes when ideally one could have been used), but also increases the complex-
	   ity involved in development and maintenance because of the unnecessary separation
	   of cohesive methods
</p>

<p>
Reification
“Reification” is the promotion or elevation of something that is not an object into an
object. When we reify behavior, it is possible to store it, pass it, or transform it. Reifica-
tion improves flexibility of the system at the cost of introducing some complexity [52].
Many design patterns [54] employ reification. Examples:
</p>


<p>
• State pattern: Encoding a state-machine.
</p>

<p>
• Command pattern: Encoding requests as command objects. A permitted excep-
tion for this smell is when a Command pattern has been used to objectify
method requests.
</p>

<p>
• Strategy pattern: Parameterizing a procedure in terms of an operation it uses.
</p>

<p>
In other words, when we consciously design in such a way to elevate non-objects
to objects for better reusability, flexibility, and extensibility (i.e., for improving
design quality), it is not a smell.
</p>


<p>
ALIASES
“Operation class” [51,52] — This smell occurs when an operation that should
have been a method within a class has been turned into a class itself.
</p>
</div>
</li>
<li><a id="org53b6e68"></a>Incomplete Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-3">
<p>
An abstraction (entity or interface) does not support complementary or interrelated methods completely
For example, if we need to be able to add or remove elements in a data
structure, the type abstracting that data structure should support both add() and
remove() methods. Supporting only one of them makes the abstraction incomplete
and incoherent in the context of those interrelated methods.
</p>

<p>
missing “complementary and symmetric” methods,
</p>

<p>
Min/max Open/close Create/destroy Get/set
Read/write Print/scan First/last Begin/end
Start/stop Lock/unlock Show/hide Up/down
First/last Push/pull
Enable/disable  Left/right On/off
</p>

<p>
Sometimes, a designer may make a conscious design decision to not provide sym-
metric or matching methods. For example, in a read-only collection, only add()
method may be provided without the corresponding remove() method. In such a
case, the abstraction may appear incomplete, but is not a smell.
</p>


<p>
Sometimes, APIs choose to replace symmetrical methods with a method that takes
a boolean argument (for instance, to enforce a particular naming convention such as
naming convention that requires accessors to have prefixes “get,” “is,” or
“set”). For example, classes such as java.awt.MenuItem and java.awt.Component
originally supported disable() and enable() methods. These methods were dep-
recated and are now replaced with setEnabled(boolean) method. Similarly, java.
awt.Component has the method setVisible(boolean) that deprecates the methods
show() and hide(). One would be tempted to mark these classes as Incomplete
Abstractions since they lack symmetric methods, i.e., getEnabled() and getVisi-
ble() respectively. However, since there is no need for corresponding getter methods
(as these methods take a boolean argument), these classes do not have Incomplete
Abstraction smell.
</p>




<p>
ALIASES
This smell is also known in literature as:
</p>

<p>
• “Class supports incomplete behavior” [18]—This smell occurs when the public
interface of a class is incomplete and does not support all the behavior needed
by objects of that class.
</p>

<p>
• “Half-hearted operations” [63]—This smell occurs when interrelated methods
provided in an incomplete or in an inconsistent way; this smell could lead to
runtime problems.
</p>
</div>
</li>
<li><a id="org1f3b555"></a>Multifaceted Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-4">
<p>
This smell arises when an abstraction has more than one responsibility assigned to it.
</p>

<p>
In particular, the Single Responsibility Principle says that an abstraction should have a single
well-defined responsibility and that responsibility should be entirely encapsulated
within that abstraction. 
</p>

<p>
ALIASES
This smell is also known in literature as:
</p>

<p>
• “Divergent change” [7]—This smell occurs when a class is changed for differ-
ent reasons.
</p>

<p>
• “Conceptualization abuse” [30]—This smell occurs when two or more non-
cohesive concepts have been packed into a single class of the system.
</p>

<p>
• “Large class” [7,24,57,58]—This smell occurs when a class has “too many”
responsibilities.
</p>

<p>
• “Lack of cohesion” [59]—This smell occurs when there is a large type in a
design with low cohesion, i.e., a “kitchen sink” type that represents many
abstractions.
</p>
</div>
</li>
<li><a id="org43c1c1a"></a>Unnecessary Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-5">
<p>
An abstraction that is not needed
ALIASES:
Irrelevant class - class does not have any meaningful behavior in the design
Lazy class / Freeloader — class does “too little”
Small class - class has no (or too few) variables or no (or too few) methods in it
Mini-class - a public, non-nested class defines less than three methods and less than three attributes (including constants) in it
No responsibility - class has no responsibility associated with it
Agent classes - class serve as an “agent” (i.e., they only pass messages from one class to another), indicating that the class may be unnecessary
</p>
</div>
</li>
<li><a id="org8c17fe8"></a>Unutilized Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-6">
<p>
UNUTILIZED ABSTRACTION
An abstraction is left unused (either not directly used or not
reachable). This smell manifests in two forms:
</p>

<p>
• Unreferenced abstractions—Concrete classes that are not being used by anyone
• Orphan abstractions—Stand-alone interfaces/abstract classes that do not have
any derived abstractions
</p>


<p>
		This smell violates the principle YAGNI (You
Aren’t Gonna Need It), which recommends not adding functionality until deemed
necessary [53]
</p>

<p>
		When an abstraction is left unused
in design, it does not serve a meaningful purpose in design, and hence violates the
principle of abstraction.
</p>

<p>
POTENTIAL CAUSES:
Leftover garbage during maintenance or refactoring.
Speculative generality - abstractions are introduced speculating that they may be required sometime in future.
</p>


<p>
REFACTORING:
remove the Unutilized Abstraction from the design.
</p>

<p>
IMPACT:
pollutes the design space and increases cognitive load. This impacts understandability.
UNUTILIZED ABSTRACTION
Two or more abstractions have identical names or identical implementation or both
</p>


<p>
POTENTIAL CAUSES:
</p>

<p>
Copy-paste programming
The “get-the-work-done” mindset of a programmer leads him to copy and paste code
instead of applying proper abstraction.
Ad hoc maintenance
When the software undergoes haphazard fixes or enhancements over many years, it
leaves “crufts”6 with lots of redundant code in it.
Lack of communication
Often, in industrial software, code duplication occurs because different people work
on the same code at different times in the life cycle of the software. They are not
aware of existing classes or methods and end up re-inventing the wheel.
</p>

<p>
REFACTORING:
For identical name form, the suggested refactoring is to rename one of the abstrac-
tions to a unique name.
In the case of the identical implementation form of Duplicate Abstraction, if the
implementations are exactly the same, one of the implementations can be removed.
If the implementations are slightly different, then the common implementation in
the duplicate abstractions can be factored out into a common class.
</p>


<p>
IMPACT:
it affects understandability of the design. Developers of client code will be confused and unclear about the choice
of the abstraction that should be used by their code.
</p>

<p>
identical implementation (i.e., they have duplicate code), it becomes difficult to maintain them.
In summary, this smell indicates a violation of the DRY (Don’t Repeat Yourself)
principle.
		If the DRY principle is not fol-
lowed, a modification of an element within the system requires modifications to other
logically unrelated elements making maintainability a nightmare. Since there is dupli-
cation among abstractions in the design, this smell is named Duplicate Abstraction.
</p>

<p>
3.7.6 ALIASES
This smell is also known in literature as:
</p>

<p>
•	“Alternative classes with different interfaces” [7]—This smell occurs when
classes do similar things, but have different names.
•	“Duplicate design artifacts” [74]—This smell occurs when equivalent design
artifacts are replicated throughout the architecture.
</p>
</div>
</li>
<li><a id="org6bf632e"></a>Duplicate Abstraction<br />
<div class="outline-text-5" id="text-5-1-1-7">
<p>
UNUTILIZED ABSTRACTION
Two or more abstractions have identical names or identical implementation or both
</p>


<p>
POTENTIAL CAUSES:
</p>

<p>
Copy-paste programming
The “get-the-work-done” mindset of a programmer leads him to copy and paste code
instead of applying proper abstraction.
Ad hoc maintenance
When the software undergoes haphazard fixes or enhancements over many years, it
leaves “crufts”6 with lots of redundant code in it.
Lack of communication
Often, in industrial software, code duplication occurs because different people work
on the same code at different times in the life cycle of the software. They are not
aware of existing classes or methods and end up re-inventing the wheel.
</p>

<p>
REFACTORING:
For identical name form, the suggested refactoring is to rename one of the abstrac-
tions to a unique name.
In the case of the identical implementation form of Duplicate Abstraction, if the
implementations are exactly the same, one of the implementations can be removed.
If the implementations are slightly different, then the common implementation in
the duplicate abstractions can be factored out into a common class.
</p>


<p>
IMPACT:
it affects understandability of the design. Developers of client code will be confused and unclear about the choice
of the abstraction that should be used by their code.
</p>

<p>
identical implementation (i.e., they have duplicate code), it becomes difficult to maintain them.
In summary, this smell indicates a violation of the DRY (Don’t Repeat Yourself)
principle.
		If the DRY principle is not fol-
lowed, a modification of an element within the system requires modifications to other
logically unrelated elements making maintainability a nightmare. Since there is dupli-
cation among abstractions in the design, this smell is named Duplicate Abstraction.
</p>

<p>
3.7.6 ALIASES
This smell is also known in literature as:
</p>

<p>
•	“Alternative classes with different interfaces” [7]—This smell occurs when
classes do similar things, but have different names.
•	“Duplicate design artifacts” [74]—This smell occurs when equivalent design
artifacts are replicated throughout the architecture.
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org8ad0bf0" class="outline-4">
<h4 id="org8ad0bf0"><span class="section-number-4">5.1.2</span> encapsulation</h4>
</div>
<div id="outline-container-org43db3dc" class="outline-4">
<h4 id="org43db3dc"><span class="section-number-4">5.1.3</span> modularization</h4>
</div>
<div id="outline-container-org7f65a35" class="outline-4">
<h4 id="org7f65a35"><span class="section-number-4">5.1.4</span> hierarchy</h4>
</div>
</div>
<div id="outline-container-org6795a9e" class="outline-3">
<h3 id="org6795a9e"><span class="section-number-3">5.2</span> Normal</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-org857cf06" class="outline-4">
<h4 id="org857cf06"><span class="section-number-4">5.2.1</span> Alias Duplicates</h4>
<div class="outline-text-4" id="text-5-2-1">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">App\Model\Category\Query</span> <span style="color: #ffffff;">as</span> <span style="color: #7fffd4;">CategoryQuery</span>;
<span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">App\Model\Product\Contract\Query</span> <span style="color: #ffffff;">as</span> <span style="color: #7fffd4;">ProductQueryInterface</span>;
<span style="color: #ffffff;">use</span> <span style="color: #7fffd4;">App\Contract\Query</span> <span style="color: #ffffff;">as</span>
</pre>
</div>
<p>
<a href="https://www.tomasvotruba.cz/blog/2019/05/02/alias-as-a-code-smell/">https://www.tomasvotruba.cz/blog/2019/05/02/alias-as-a-code-smell/</a>
</p>
</div>
</div>
<div id="outline-container-org967dc80" class="outline-4">
<h4 id="org967dc80"><span class="section-number-4">5.2.2</span> Alternative Classes With Different Interfaces</h4>
</div>
<div id="outline-container-org8915bf3" class="outline-4">
<h4 id="org8915bf3"><span class="section-number-4">5.2.3</span> Comments</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
If you need a comment to explain what a block of code does, try Extract Function (106). If the method is already extracted but you still need a comment to explain what it does, use Change Function Declaration (124) to rename it. If you need to state some rules about the required state of the system, use Introduce Assertion (302).
</p>
</div>
</div>
<div id="outline-container-org977b0c1" class="outline-4">
<h4 id="org977b0c1"><span class="section-number-4">5.2.4</span> Data Class</h4>
</div>
<div id="outline-container-orgc98b96a" class="outline-4">
<h4 id="orgc98b96a"><span class="section-number-4">5.2.5</span> Data Clumps</h4>
<div class="outline-text-4" id="text-5-2-5">
<p>
Fix: Use Extract Class (182) on the fields to turn the clumps into an object.
</p>
</div>
</div>
<div id="outline-container-org6a529e4" class="outline-4">
<h4 id="org6a529e4"><span class="section-number-4">5.2.6</span> Divergent Change</h4>
<div class="outline-text-4" id="text-5-2-6">
<p>
Within Classes
</p>
</div>
</div>
<div id="outline-container-orgcf17a39" class="outline-4">
<h4 id="orgcf17a39"><span class="section-number-4">5.2.7</span> Duplicated Code</h4>
<div class="outline-text-4" id="text-5-2-7">
<p>
Within Classes
Same code structure in more than one place
Don't Repeat Yourself (DRY)
</p>
</div>
<ol class="org-ol">
<li><a id="orgbdd74a7"></a>Same expression in different places<br />
<div class="outline-text-5" id="text-5-2-7-1">
<p>
The simplest duplicated code problem is when you have the same expression in two
methods of the same class. Then all you have to do is Extract Function and invoke the code from both places.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org3c88083" class="outline-4">
<h4 id="org3c88083"><span class="section-number-4">5.2.8</span> Feature Envy</h4>
<div class="outline-text-4" id="text-5-2-8">
<p>
Between Classes	A method accesses the data of another object more than its own data
</p>
</div>
</div>
<div id="outline-container-org31af9f8" class="outline-4">
<h4 id="org31af9f8"><span class="section-number-4">5.2.9</span> Global Data</h4>
<div class="outline-text-4" id="text-5-2-9">
<p>
"Global data is especially nasty when it’s mutable. Global data that you can guarantee
never changes after the program starts is relatively safe—if you have a language that can
enforce that guarantee."
Fix: Encapsulate Variable
</p>
</div>
</div>
<div id="outline-container-org8496c18" class="outline-4">
<h4 id="org8496c18"><span class="section-number-4">5.2.10</span> Insider Trading</h4>
</div>
<div id="outline-container-org0386bb1" class="outline-4">
<h4 id="org0386bb1"><span class="section-number-4">5.2.11</span> Large Class</h4>
<div class="outline-text-4" id="text-5-2-11">
<p>
Within Classes	
A class contains too many fields, methods, lines of code.
Fix: Extract Class, Extract Superclass, Replace Type Code with Subclass
</p>
</div>
</div>
<div id="outline-container-org5334d45" class="outline-4">
<h4 id="org5334d45"><span class="section-number-4">5.2.12</span> Lazy Element</h4>
<div class="outline-text-4" id="text-5-2-12">
<p>
It may be a function that’s named the same as its body code reads, or a class that is essentially one simple function.
Fix: Inline Function, Inline Class, Collapse Hierarchy
</p>
</div>
</div>
<div id="outline-container-org2293e96" class="outline-4">
<h4 id="org2293e96"><span class="section-number-4">5.2.13</span> Long Function</h4>
<div class="outline-text-4" id="text-5-2-13">
<p>
Within Classes
Fix: Extract Function
</p>
</div>
</div>
<div id="outline-container-orgee215b1" class="outline-4">
<h4 id="orgee215b1"><span class="section-number-4">5.2.14</span> Long Parameter List</h4>
<div class="outline-text-4" id="text-5-2-14">
<p>
Within Classes
Fix: Replace Parameter with Query, Preserve Whole Object, INtroduce PArameter Object, Remove Flag Argument, Combine Functions into Class
</p>
</div>
</div>
<div id="outline-container-org3eab08e" class="outline-4">
<h4 id="org3eab08e"><span class="section-number-4">5.2.15</span> Loops</h4>
<div class="outline-text-4" id="text-5-2-15">
<p>
Fix: Replace Loop with Pipeline
</p>
</div>
</div>
<div id="outline-container-org29eb9a2" class="outline-4">
<h4 id="org29eb9a2"><span class="section-number-4">5.2.16</span> Message Chains</h4>
<div class="outline-text-4" id="text-5-2-16">
<p>
You see message chains when a client asks one object for another object, which the client then asks for yet another object, which the client then asks for yet another another object, and so on.
</p>


<p>
95 
</p>
</div>
</div>
<div id="outline-container-orgc009695" class="outline-4">
<h4 id="orgc009695"><span class="section-number-4">5.2.17</span> Middle Man</h4>
<div class="outline-text-4" id="text-5-2-17">
<p>
Fix: Remove Middle Man, Inline Function, Replace Superclass with Delegate, Replace Subclass with Delegate
</p>
</div>
</div>
<div id="outline-container-orge0d4acf" class="outline-4">
<h4 id="orge0d4acf"><span class="section-number-4">5.2.18</span> Mysterious Name</h4>
<div class="outline-text-4" id="text-5-2-18">
<p>
Fix: Change Function Declaration, Rename Variable, Rename Field
</p>
</div>
</div>
<div id="outline-container-org7a1859f" class="outline-4">
<h4 id="org7a1859f"><span class="section-number-4">5.2.19</span> Primitive Obsession</h4>
<div class="outline-text-4" id="text-5-2-19">
<p>
Primitive types: integers, floating point numbers and strings. Money, coordinates or ranges.
Fix: Replace Primitive with Object
</p>
</div>
</div>
<div id="outline-container-org304a446" class="outline-4">
<h4 id="org304a446"><span class="section-number-4">5.2.20</span> Refused Bequest</h4>
</div>
<div id="outline-container-org755471b" class="outline-4">
<h4 id="org755471b"><span class="section-number-4">5.2.21</span> Repeated Switches</h4>
</div>
<div id="outline-container-org8e9071b" class="outline-4">
<h4 id="org8e9071b"><span class="section-number-4">5.2.22</span> Shotgun Surgery</h4>
</div>
<div id="outline-container-orgb1e1c91" class="outline-4">
<h4 id="orgb1e1c91"><span class="section-number-4">5.2.23</span> Speculative Generality</h4>
<div class="outline-text-4" id="text-5-2-23">
<p>
“Oh, I think we’ll need the ability to do this kind of thing someday”
</p>
</div>
</div>
<div id="outline-container-org3c5c718" class="outline-4">
<h4 id="org3c5c718"><span class="section-number-4">5.2.24</span> Temporary Field</h4>
</div>
</div>
</div>
<div id="outline-container-orgb0d9d54" class="outline-2">
<h2 id="orgb0d9d54"><span class="section-number-2">6</span> Codebases</h2>
<div class="outline-text-2" id="text-6">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-right">Lines of Code</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Tutorials</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><a href="https://github.com/adamculp/refactoring101">Video Rental Shop</a></td>
<td class="org-right">132</td>
<td class="org-left">From Martin Fowler book "Refactoring: Improving the Design of Existing Code" converted to PHP</td>
<td class="org-left"><a href="https://youtu.be/0DYIJdX6kB4">Refactoring 101</a></td>
</tr>

<tr>
<td class="org-left"><a href="https://github.com/jbrains/trivia/tree/master/php">Legacy Code Retreat - Trivia Game</a></td>
<td class="org-right">196</td>
<td class="org-left">Designed for <a href="https://legacycoderetreat.typepad.com/">Legacy Code Retreat</a> events</td>
<td class="org-left"><a href="https://code.tutsplus.com/series/refactoring-legacy-code--cms-633">Refactoring Legacy Code</a></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><a href="https://code.tutsplus.com/courses/techniques-for-refactoring-code">Techniques for Refactoring Code</a></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><a href="http://blog.adrianbolboaca.ro/2014/04/legacy-coderetreat/#sessions">Legacy Coderetreat (Java)</a></td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org8e13547" class="outline-3">
<h3 id="org8e13547"><span class="section-number-3">6.1</span> <a href="https://github.com/adamculp/refactoring101">Video Rental Shop</a></h3>
<div class="outline-text-3" id="text-6-1">
<p>
   phploc
Size
  Lines of Code (LOC)                              132
  Comment Lines of Code (CLOC)                      12 (9.09%)
  Non-Comment Lines of Code (NCLOC)                120 (90.91%)
  Logical Lines of Code (LLOC)                      48 (36.36%)
    Classes                                         40 (83.33%)
      Average Class Length                          13
        Minimum Class Length                         6
        Maximum Class Length                        24
      Average Method Length                          2
        Minimum Method Length                        1
        Maximum Method Length                       19
    Functions                                        0 (0.00%)
      Average Function Length                        0
    Not in classes or functions                      8 (16.67%)
</p>

<p>
Structure
  Namespaces                                         0
  Interfaces                                         0
  Traits                                             0
  Classes                                            3
    Abstract Classes                                 0 (0.00%)
    Concrete Classes                                 3 (100.00%)
  Methods                                           11
    Scope
      Non-Static Methods                            11 (100.00%)
      Static Methods                                 0 (0.00%)
    Visibility
      Public Methods                                11 (100.00%)
      Non-Public Methods                             0 (0.00%)
  Functions                                          0
    Named Functions                                  0 (0.00%)
    Anonymous Functions                              0 (0.00%)
  Constants                                          3
    Global Constants                                 0 (0.00%)
    Class Constants                                  3 (100.00%)
</p>

<p>
Cyclomatic Complexity
  Average Complexity per LLOC                     0.17
  Average Complexity per Class                    3.67
    Minimum Class Complexity                      1.00
    Maximum Class Complexity                      9.00
  Average Complexity per Method                   1.73
    Minimum Method Complexity                     1.00
    Maximum Method Complexity                     9.00
</p>

<p>
Dependencies
  Global Accesses                                    0
    Global Constants                                 0 (0.00%)
    Global Variables                                 0 (0.00%)
    Super-Global Variables                           0 (0.00%)
  Attribute Accesses                                15
    Non-Static                                      15 (100.00%)
    Static                                           0 (0.00%)
  Method Calls                                      14
    Non-Static                                      14 (100.00%)
    Static                                           0 (0.00%)
</p>
</div>
</div>
<div id="outline-container-orgff2a8ef" class="outline-3">
<h3 id="orgff2a8ef"><span class="section-number-3">6.2</span> <a href="https://github.com/jbrains/trivia/tree/master/php">Legacy Code Retreat - Trivia Game</a></h3>
<div class="outline-text-3" id="text-6-2">
<p>
   phploc
Size
  Lines of Code (LOC)                              196
  Comment Lines of Code (CLOC)                       0 (0.00%)
  Non-Comment Lines of Code (NCLOC)                196 (100.00%)
  Logical Lines of Code (LLOC)                      99 (50.51%)
    Classes                                         88 (88.89%)
      Average Class Length                          88
        Minimum Class Length                        88
        Maximum Class Length                        88
      Average Method Length                          7
        Minimum Method Length                        1
        Maximum Method Length                       17
    Functions                                        1 (1.01%)
      Average Function Length                        1
    Not in classes or functions                     10 (10.10%)
</p>

<p>
Cyclomatic Complexity
  Average Complexity per LLOC                     0.26
  Average Complexity per Class                   25.00
    Minimum Class Complexity                     25.00
    Maximum Class Complexity                     25.00
  Average Complexity per Method                   3.18
    Minimum Method Complexity                     1.00
    Maximum Method Complexity                    10.00
</p>

<p>
Dependencies
  Global Accesses                                    0
    Global Constants                                 0 (0.00%)
    Global Variables                                 0 (0.00%)
    Super-Global Variables                           0 (0.00%)
  Attribute Accesses                               115
    Non-Static                                     115 (100.00%)
    Static                                           0 (0.00%)
  Method Calls                                      21
    Non-Static                                      21 (100.00%)
    Static                                           0 (0.00%)
</p>

<p>
Structure
  Namespaces                                         0
  Interfaces                                         0
  Traits                                             0
  Classes                                            1
    Abstract Classes                                 0 (0.00%)
    Concrete Classes                                 1 (100.00%)
  Methods                                           11
    Scope
      Non-Static Methods                            11 (100.00%)
      Static Methods                                 0 (0.00%)
    Visibility
      Public Methods                                11 (100.00%)
      Non-Public Methods                             0 (0.00%)
  Functions                                          1
    Named Functions                                  1 (100.00%)
    Anonymous Functions                              0 (0.00%)
  Constants                                          0
    Global Constants                                 0 (0.00%)
    Class Constants                                  0 (0.00%)
</p>
</div>
</div>
</div>
<div id="outline-container-orga268efa" class="outline-2">
<h2 id="orga268efa"><span class="section-number-2">7</span> Tools</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org0dc551a" class="outline-3">
<h3 id="org0dc551a"><span class="section-number-3">7.1</span> serializer</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li><a href="https://thomas.jarrand.fr/blog/serialization/">https://thomas.jarrand.fr/blog/serialization/</a></li>
<li><a href="https://matthiasnoback.nl/2017/07/designing-a-json-serializer/">https://matthiasnoback.nl/2017/07/designing-a-json-serializer/</a></li>
<li><a href="https://stackoverflow.com/questions/35365141/symfony-serializer-set-circular-reference-global/35365239">https://stackoverflow.com/questions/35365141/symfony-serializer-set-circular-reference-global/35365239</a></li>
<li><a href="https://speakerdeck.com/dunglas/mastering-the-symfony-serializer?slide=1">https://speakerdeck.com/dunglas/mastering-the-symfony-serializer?slide=1</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb4b23c8" class="outline-2">
<h2 id="orgb4b23c8"><span class="section-number-2">8</span> Jokes</h2>
<div class="outline-text-2" id="text-8">
<p>
“There is so much spaghetti I might as well open a restaurant!”
</p>
</div>
</div>
<div id="outline-container-org4ca8357" class="outline-2">
<h2 id="org4ca8357"><span class="section-number-2">9</span> Metrics</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org7188248" class="outline-3">
<h3 id="org7188248"><span class="section-number-3">9.1</span> Cyclomatic Complexity Number (CCN)</h3>
<div class="outline-text-3" id="text-9-1">
<p>
Counts the available decision paths in a source code to determine it's complexity.
Each decision path starts with one of the conditional statements from the following list:
</p>
<ul class="org-ul">
<li>?</li>
<li>&amp;&amp;</li>
<li>||</li>
<li>or</li>
<li>and</li>
<li>xor</li>
<li>case</li>
<li>catch</li>
<li>elseif</li>
<li>for</li>
<li>foreach</li>
<li>if</li>
<li>while</li>
</ul>

<p>
Cyclomatic Complexity Number is never less than 1, because there’s always at least one code path.
</p>
<ul class="org-ul">
<li>1-4 has low complexity.</li>
<li>5-7 is moderate and still easy to understand.</li>
<li>6-10 has a high complexity.</li>
<li>10+ is very complex and hard to understand.</li>
</ul>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">CyclomaticComplexityNumber</span>
{
    <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Class Cyclomatic Complexity = 1</span>
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">CyclomaticComplexityNumber</span>
{

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">one</span>()
    {
        <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Function Cyclomatic Complexity = 1</span>
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">two</span>()
    {
        <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Function Cyclomatic Complexity = 1</span>
    }

    <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Class Cyclomatic Complexity = 1</span>
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">CyclomaticComplexityNumber</span>
{

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">one</span>()
    {
        <span style="color: #ffffff;">if</span>(<span style="color: #40e0d0;">true</span>){

        }
        <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Function Cyclomatic Complexity = 2</span>
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">two</span>()
    {
        <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Function Cyclomatic Complexity = 1</span>
    }

    <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Class Cyclomatic Complexity = 1 + 1 = 2</span>
}

<span style="color: #ffffff;">final</span> <span style="color: #ffffff;">class</span> <span style="color: #7fffd4;">CyclomaticComplexityNumber</span>
{

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">one</span>()
    {
        <span style="color: #ffffff;">if</span>(<span style="color: #40e0d0;">true</span>){

        }
        <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Function Cyclomatic Complexity = 2</span>
    }

    <span style="color: #ffffff;">public</span> <span style="color: #ffffff;">function</span> <span style="color: #98fb98;">two</span>()
    {
        <span style="color: #ffffff;">if</span>(<span style="color: #40e0d0;">true</span>){

        }
        <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Function Cyclomatic Complexity = 2</span>
    }

    <span style="color: #00cd66;">// </span><span style="color: #00cd66;">Class Cyclomatic Complexity = 1 + 1 + 1 = 3</span>
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf6cdc78" class="outline-3">
<h3 id="orgf6cdc78"><span class="section-number-3">9.2</span> NPath Complexity</h3>
<div class="outline-text-3" id="text-9-2">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffffff;">function</span> <span style="color: #98fb98;">foo</span>(<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">a</span>, <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">b</span>)
{
    <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">a</span> &gt; 10) {
        <span style="color: #ffffff;">echo</span> 1;
    } <span style="color: #ffffff;">else</span> {
        <span style="color: #ffffff;">echo</span> 2;
    }
    <span style="color: #ffffff;">if</span> (<span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">a</span> &gt; <span style="color: #f5deb3; background-color: #000000;">$</span><span style="color: #9acd32;">b</span>) {
        <span style="color: #ffffff;">echo</span> 3;
    } <span style="color: #ffffff;">else</span> {
        <span style="color: #ffffff;">echo</span> 4;
    }
}
</pre>
</div>
<p>
So here we have function with 4 possible outcomes, since we have 2 statements that have 2 possible outcomes each (2 * 2 = 4). That means that the functions Npath complexity is 4. If we would add another statement with 2 possible outcomes we would get a complexity of 8 since 2 * 2 * 2 = 8.
</p>
</div>
</div>
</div>
<div id="outline-container-org089d6f6" class="outline-2">
<h2 id="org089d6f6"><span class="section-number-2">10</span> About</h2>
<div class="outline-text-2" id="text-10">
<p>
It's a simple site about refactoring in PHP.
</p>

<p>
You can contact me at slawomir.grochowski@gmail.com, <a href="https://twitter.com/s_grochowski">https://twitter.com/s_grochowski</a>, <a href="https://www.facebook.com/SlawomirGrochowski">https://www.facebook.com/SlawomirGrochowski</a>
You can support this site: send some BitCoins 1D8xeRkxssTTLESfGZtPVoqVJDq7MJSqNx , send/buy one of the books I would like to read or just say Hello!
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: slk500</p>
<p class="date">Created: 2019-06-26 Wed 14:02</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
